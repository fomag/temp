/*!
 * Web Experience Toolkit (WET) / Boîte à  outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v6.0.0 - 2020-04-08
 * + Experimental wb5 with datatable
 * + Chat wizard update
 */!function(z,D,O){"use strict";function u(e,t,a){var r,n,i;for(r=a[t];n=r.shift();)(i=n.action)&&(e.trigger(i+"."+M,n),delete n.action)}var e=D.doc,p="wb-actionmng",l="."+p,t="[data-"+p+"]",L=p+"Rn",M=p+l,f={},h={},B={},a=["mapfilter","tocsv","loadJSON","patch","ajax","addClass","removeClass","tblfilter","withInput","run"].join("."+M+" ")+"."+M,b={op:"move",path:"{base}",from:"{base}/{qval}"},g=function(e,t,a){t[e]||(t[e]=[]),t[e].push(a)},U=function(e,t,a,r){var n,i,o,s,l,c,d;for(i=(a=z.isArray(a)?z.extend([],a):[a]).length,n=0;n!==i;n+=1)if(s=(o=a[n]).action){if(l=o.match,d=o.default,c=!1,l&&!d)throw"'match' and 'default' property need to be set";if(d&&t.length&&"string"==typeof l)try{c=(c=new RegExp(l).exec(t))||d}catch(e){}else c||!d||t||(c=d);switch(!o.qval&&c&&(o.qval=c),s){case"patch":var u=o.patches,p=o.base||"/";u||(u=[b],o.cumulative=!0),z.isArray(u)||(u=[u]),u=m(u,o.qval,p),o.patches=u;break;case"ajax":o.trigger&&r&&(o.trigger=!1),o.url=v(o.url,o.qval);break;case"tblfilter":o.value=v(o.value,o.qval)}g(e,h,o)}},m=function(e,t,a){var r,n,i,o=e.length,s=[];for(a=a||"/",r=0;r!==o;r+=1)n=e[r],i=z.extend({},n),n.path&&(i.path=v(n.path,t,a)),n.from&&(i.from=v(n.from,t,a)),n.value&&(i.value=v(n.value,t,a)),s.push(i);return s},v=function(e,t,a){return t?a?e.replace(/\{qval\}/,t).replace(/\{base\}/,a):e.replace(/\{qval\}/,t):e};e.on("do."+M,function(e){var t,a,r,n,i,o,s,l=e.element||e.target,c=l.id,d=e.actions||[];if((l===e.target||e.currentTarget===e.target)&&-1===l.className.indexOf(p)){for(z.isArray(d)||(d=[d]),(r=d.length)&&(t=z(l)).addClass(p),c&&f[c]&&u(t,c,f),a=0;a!==r;a+=1)(i=(n=d[a]).action)&&((o=n.target)?(n.trgbefore?g(o,f,n):g(o,h,n),(s=n.trggroup)&&g(s,B,n)):t.trigger(i+"."+M,n));c&&h[c]&&u(t,c,h),z(e.target).removeClass(p)}}),e.on("clean."+M,function(e){var t,a,r=e.element||e.target,n=e.trggroup;if((r===e.target||e.currentTarget===e.target)&&n&&B[n])for(t=B[n];a=t.shift();)delete a.action}),e.on(a,l,function(e,t){var a,r,n,i,o,s,l,c,d,u,p,f,h,b,g,m,v,w,y,x,k,A,j,C,E,S,I,T,q,N=e.type;if(M===e.namespace)switch(N){case"run":!function(e,t){var a,r,n,i,o=e.target,s=z(o),l=B[t.trggroup];if(l&&!s.hasClass(L)){for(s.addClass(L),r=l.length,a=0;a!==r;a+=1)(i=(n=l[a]).action)&&s.trigger(i+"."+M,n);s.removeClass(L)}}(e,t);break;case"tblfilter":!function(e,t){var a=e.target,r=z(t.source||a),n=t.column,i=parseInt(n,10),o=!!t.regex,s=!t.smart||!!t.smart,l=!t.caseinsen||!!t.caseinsen;if("TABLE"!==r.get(0).nodeName)throw"Table filtering can only applied on table";n=!0===i?i:n,r.dataTable({retrieve:!0}).api().column(n).search(t.value,o,s,l).draw()}(e,t);break;case"addClass":I=e,q=z((T=t).source||I.target),T.class&&q.addClass(T.class);break;case"removeClass":C=e,S=z((E=t).source||C.target),E.class&&S.removeClass(E.class);break;case"ajax":y=e,(x=t).container?k=z(x.container):(A=D.getId(),k=z("<div id='"+A+"'></div>"),z(y.target).after(k)),x.trigger&&k.attr("data-trigger-wet","true"),j=x.type?x.type:"replace",k.attr("data-ajax-"+j,x.url),k.one("wb-contentupdated",function(e,t){var a=e.currentTarget,r=a.getAttribute("data-trigger-wet");a.removeAttribute("data-ajax-"+t["ajax-type"]),r&&(z(a).find(D.allSelectors).addClass("wb-init").filter(":not(#"+a.id+" .wb-init .wb-init)").trigger("timerpoke.wb"),a.removeAttribute("data-trigger-wet"))}),k.trigger("wb-update.wb-data-ajax");break;case"patch":m=(g=t).source,v=g.patches,w=!!g.cumulative,v&&(z.isArray(v)||(v=[v]),z(m).trigger({type:"patches.wb-jsonmanager",patches:v,fpath:g.fpath,filter:g.filter||[],filternot:g.filternot||[],cumulative:w}));break;case"mapfilter":u=e,f=z((p=t).source||u.target).get(0).geomap,h=p.filter,b=p.value,"aoi"===h&&f.zoomAOI(b),"layer"===h&&f.showLayer(b,!0);break;case"tocsv":!function(e,t){var a,r,n,i=z(e),o=i.get(0),s=o.classList.contains("wb-tables"),l="",c=t||(o.caption||"table")+".csv",d=o.rows,u=d.length,p=d[0].cells.length;if(s){for(u=(n=i.dataTable({retrieve:!0}).api()).rows()[0].length,r=0;r<p;r+=1)f=(f=d[0].cells[r].textContent).replace(/\"/g,'""'),l=r?l+',"'+f+'"':l+'"'+f+'"';l+="\n"}for(a=0;a<u;a+=1){for(r=0;r<p;r+=1){var f;if(s){if(-1!==(f=n.cell(a,r,{page:"all"}).data()).indexOf("<")){var h=O.createElement("div");h.innerHTML=f,f=h.textContent}}else f=d[a].cells[r].textContent;f=f.replace(/\"/g,'""'),f+='"',l=r?l+',"'+f:l+'"'+f}l+="\n"}D.download(new Blob([l],{type:"text/plain;charset=utf-8"}),c)}(t.source,t.filename);break;case"loadJSON":c=(l=t).source,d=l.url,z(c).attr("data-wb-jsonmanager-reload",""),z(c).trigger({type:"json-fetch.wb",fetch:{url:d,nocache:l.nocache,nocachekey:l.nocachekey}});break;case"withInput":a=e,n=(r=t).cValue||z(r.srcInput).val()||"",o=(i=r).dntwb,s=a.target,U(s.id,n,i.actions,o)}}),e.on("timerpoke.wb wb-init.wb-actionmng",t,function(e){var t,a,r,n,i,o,s=D.init(e,p,l);if(s){if(t=z(s),a=D.getData(t,p))for(z.isArray(a)||(a=[a]),n=a.length,r=0;r!==n;r+=1)(o=(i=a[r]).trggroup)&&i.action&&g(o,B,i);D.ready(t,p)}}),D.add(t)}(jQuery,wb,document),function(a,r){"use strict";var e=r.doc,n="wb-bgimg",i="[data-bgimg]";e.on("timerpoke.wb wb-init."+n,i,function(e){var t=r.init(e,n,i);t&&(t.style.backgroundImage="url("+t.dataset.bgimg+")",r.ready(a(t),n))}),r.add(i)}(jQuery,wb),function(j,c,C){"use strict";var e,p="wb-data-json",u="wb-json",t=["[data-json-after]","[data-json-append]","[data-json-before]","[data-json-prepend]","[data-json-replace]","[data-json-replacewith]","[data-"+u+"]"],f=["after","append","before","prepend","val"],h=/(href|src|data-*|pattern|min|max|step|low|high)/,b=/(checked|selected|disabled|required|readonly|multiple|hidden)/,a=t.length,g=t.join(","),m=p+"-queue",r=C.doc,v=function(e,t,a,r,n){var i,o=j(e),s={url:t,refId:a,nocache:r,nocachekey:n},l=c[p];!l||"http"!==t.substr(0,4)&&"//"!==t.substr(0,2)||(i=C.getUrlParts(t),C.pageUrlParts.protocol===i.protocol&&C.pageUrlParts.host===i.host||Modernizr.cors&&!l.forceCorsFallback||"function"==typeof l.corsFallback&&(s.dataType="jsonp",s.jsonp="callback",s=l.corsFallback(s))),o.trigger({type:"json-fetch.wb",fetch:s})},E=function(e,t,a){var r,n,i,o,s,l,c,d,u,p,f,h,b,g=t.mapping||[{}],m=t.filter||[],v=t.filternot||[],w=t.queryall,y=t.tobeclone,x=e.className,k=e,A=t.source?document.querySelector(t.source):e.querySelector("template");if(j.isArray(a)||(a="object"!=typeof a?[a]:j.map(a,function(e,t){return"object"!=typeof e||j.isArray(e)?e={"@id":t,"@value":e}:e["@id"]||(e["@id"]=t),[e]})),i=a.length,j.isArray(g)||(g=[g]),r=g.length,"TABLE"===e.tagName&&g&&-1!==x.indexOf("wb-tables-inited")&&"string"==typeof g[0]){for(b=j(e).dataTable({retrieve:!0}).api(),n=0;n<i;n+=1)if(o=a[n],S(o,m,v)){for(d="/"+n,h=[],s=0;s<r;s+=1)h.push(jsonpointer.get(a,d+g[s]));b.row.add(h)}b.draw()}else if(A)for(A.content||C.tmplPolyfill(A),t.appendto&&(k=j(t.appendto).get(0)),n=0;n<i;n+=1)if(o=a[n],S(o,m,v)){for(d="/"+n,u=y?A.content.querySelector(y).cloneNode(!0):A.content.cloneNode(!0),w&&(p=u.querySelectorAll(w)),s=0;s<r||0===s;s+=1)l=g[s],f=p?p[s]:l.selector?u.querySelector(l.selector):u,(c=l.attr)&&(f.hasAttribute(c)||f.setAttribute(c,""),f=f.getAttributeNode(c)),h="string"==typeof o?o:"string"==typeof l?jsonpointer.get(a,d+l):jsonpointer.get(a,d+l.value),l.placeholder&&(h=(f.textContent||"").replace(l.placeholder,h)),j.isArray(h)?E(f,l,h):l.isHTML?f.innerHTML=h:f.textContent=h;k.appendChild(u)}},S=function(e,t,a){var r,n,i,o=t.length,s=a.length,l=!1;if(o||s){for(r=0;r<o;r+=1)if(n=t[r],i=d(jsonpointer.get(e,n.path),n.value),n.optional)l=l||i;else{if(!i)return!1;l=!0}if(o&&!l)return!1;for(r=0;r<s;r+=1)if(n=a[r],(i=d(jsonpointer.get(e,n.path),n.value))&&!n.optional||i&&n.optional)return!1}return!0},d=function(e,t){switch(typeof e){case"undefined":return!1;case"boolean":case"string":case"number":return e===t;case"object":if(null===e)return null===t;if(j.isArray(e)){if(j.isArray(t)||e.length!==t.length)return!1;for(var a=0,r=e.length;a<r;a++)if(!d(e[a],t[a]))return!1;return!0}var n=i(t).length;if(i(e).length!==n)return!1;for(a=0;a<n;a++)if(!d(e[a],t[a]))return!1;return!0;default:return!1}},i=function(e){if(j.isArray(e)){for(var t=new Array(e.length),a=0;a<t.length;a++)t[a]=""+a;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t};r.on("json-failed.wb",g,function(){throw"Bad JSON Fetched from url in "+p}),Modernizr.load({test:"content"in document.createElement("template"),nope:"site!deps/template"+C.getMode()+".js"}),r.on("timerpoke.wb wb-init.wb-data-json wb-update.wb-data-json json-fetched.wb",g,function(e){if(e.currentTarget===e.target)switch(e.type){case"timerpoke":case"wb-init":!function(e){var t,a=C.init(e,p,g);if(a){var r,n,i,o,s,l=["before","replace","replacewith","after","append","prepend"],c=l.length,d=[];for(t=j(a),i=0;i!==c;i+=1)r=l[i],null!==(s=a.getAttribute("data-json-"+r))&&d.push({type:r,url:s});if(C.ready(t,p),(n=C.getData(t,u))&&n.url)d.push(n);else if(n&&j.isArray(n))for(c=n.length,i=0;i!==c;i+=1)d.push(n[i]);for(t.data(m,d),c=d.length,i=0;i!==c;i+=1)o=d[i],v(a,o.url,i,o.nocache,o.nocachekey)}}(e);break;case"wb-update":!function(e){var t=e.target,a=j(t),r=a.data(m),n=r.length,i=e["wb-json"];if(!i.url||!i.type&&!i.source)throw"Data JSON update not configured properly";r.push(i),a.data(m,r),v(t,i.url,n)}(e);break;default:!function(e){var t,a=e.target,r=j(a),n=r.data(m),i=e.fetch,o=n[i.refId],s=o.type,l=o.prop||o.attr,c=o.showempty,d=i.response,u=typeof d;if(c||"undefined"!=u){if(c&&"undefined"==u&&(d=""),t=jQuery.ajaxSettings.cache,jQuery.ajaxSettings.cache=!0,s)if("replace"===s)r.html(d);else if("replacewith"===s)r.replaceWith(d);else if("addclass"===s)r.addClass(d);else if("removeclass"===s)r.removeClass(d);else if("prop"===s&&l&&b.test(l))r.prop(l,d);else if("attr"===s&&l&&h.test(l))r.attr(l,d);else{if("function"!=typeof r[s]||-1===f.indexOf(s))throw p+" do not support type: "+s;r[s](d)}else s="template",E(a,o,d),o.trigger&&r.find(C.allSelectors).addClass("wb-init").filter(":not(#"+a.id+" .wb-init .wb-init)").trigger("timerpoke.wb");jQuery.ajaxSettings.cache=t,r.trigger("wb-contentupdated",{"json-type":s,content:d})}}(e)}return!0});for(e=0;e!==a;e+=1)C.add(t[e])}(jQuery,window,wb),function(a,n,r){"use strict";function i(e){if(!e.content){var t,a,r=e;for(t=r.childNodes,a=n.createDocumentFragment();t[0];)a.appendChild(t[0]);r.content=a}}var o="wb-template",s="template",e=r.doc;r.tmplPolyfill=i,e.on("timerpoke.wb wb-init.wb-template",s,function(e){var t=r.init(e,o,s);t&&(i(t),r.ready(a(t),o))}),r.add(s)}(jQuery,document,wb),function(r,n){"use strict";var i="wb-doaction",o="a[data-"+i+"],button[data-"+i+"]",s="do.wb-actionmng",l=n.doc;l.on("click",o,function(e){var t=e.target,a=r(t);if(e.currentTarget!==e.target&&(t=(a=a.parentsUntil("main",o))[0]),"BUTTON"===t.nodeName||"A"===t.nodeName)return t.id||(t.id=n.getId()),n.isReady?a.trigger({type:s,actions:n.getData(a,i)}):l.one("wb-ready.wb",function(){a.trigger({type:s,actions:n.getData(a,i)})}),!1})}(jQuery,(window,wb)),function(q,T,N){"use strict";function b(e,t){var a=t.$selElm,r=t.name,n=t.value;r&&t.provEvt.setAttribute("name",r),n&&a.val(n),a.attr("data-"+i,i)}function g(e,t){var a=q(t.origin),r=q(e.target).data($),n=t.toggle;n&&"string"==typeof n&&(n={selector:n}),n=q.extend({},n,r.toggle),a.addClass("wb-toggle"),a.trigger("toggle.wb-toggle",n),n.type="off",a.one(P,function(){a.addClass("wb-toggle"),a.trigger("toggle.wb-toggle",n),a.removeClass("wb-toggle")})}function m(e,t){var a,r,n,i,o,s,l,c,d=t.outputctnrid,u=t.actions,p=t.lblselector,f=!!t.required,h=!t.noreqlabel,b=t.items,g=e.target,m=q(g),v=t.source,w=m.data($).i18n,y=t.attributes,x=N.getId(),k="<legend class='h5 ",A="</span>",j="<fieldset id='"+x+"' data-"+W+"='"+g.id+"' "+G+"='"+v.id+"' class='"+D+" mrgn-bttm-md'",C="",E=t.typeRadCheck,S=t.inline,I=O+x;if(y&&"object"==typeof y)for(i in y)y.hasOwnProperty(i)&&(j+=" "+i+"='"+y[i]+"'");for(a=q(j+"></fieldset>"),f&&h&&(k+=" required",A+=" <strong class='required'>("+w.required+")</strong>"),k+="'>",A+="</legend>",p?(r=q("<div>"+t.label+"</div>").find(p),a.append(k+r.html()+A).append(r.nextAll()),n=r.prevAll()):a.append(q(k+t.label+A)),i=0,o=b.length;i!==o;i+=1)if((c=b[i]).group)for(C+="<p>"+c.label+"</p>",l=c.group.length,s=0;s!==l;s+=1)C+=X(c.group[s],I,E,S,f);else C+=X(c,I,E,S,f);a.append(C),q("#"+d).append(a),n&&a.before(n),u&&0<u.length&&a.data(V,u),Y(m,H,x)}var z="wb-fieldflow",u="."+z,p=z+"-form",v=z+"-sub",D=z+"-init",e="."+D,O=z+N.getId(),L="[name^="+O+"]",w=z+"-label",y=z+"-header",t="."+p,a="wb-init"+u,M="draw"+u,B="action"+u,U="submit"+u,R="submited"+u,f="ready"+u,P="clean"+u,F="reset"+u,Q="createctrl"+u,H=z+"-register",J=z+"-hdnfld",$=z+"-config",V=z+"-push",_=z+"-submit",K=z+"-action",W=z+"-origin",G="data-"+z+"-source",i=z+"-flagoptvalue",r=N.doc,h={toggle:{stateOn:"visible",stateOff:"hidden"},i18n:{en:{btn:"Continue",defaultsel:"Make your selection...",required:"required"},fr:{btn:"Allez",defaultsel:"Sélectionnez dans la liste...",required:"obligatoire"}},action:"ajax",prop:"url"},n=[["redir","query","ajax","addClass","removeClass","removeClass","append","tblfilter","toggle"].join("."+B+" ")+"."+B,["ajax","toggle","redir","addClass","removeClass"].join("."+U+" ")+"."+U,["tblfilter",z].join("."+M+" ")+"."+M,["select","checkbox","radio"].join("."+Q+" ")+"."+Q].join(" "),Y=function(e,t,a,r){var n=e.data(t);return n&&!r||(n=[]),n.push(a),e.data(t,n)},x=function(e,t){var a,r,n,i,o,s,l,c,d,u,p,f,h,b=e.get(),g=b.length,m=[];for(a=0;a!==g;a+=1){if(o=null,n=i="",d=(r=b[a]).firstChild,l=(c=r.childNodes).length,!d)throw"You have a markup error, There may be an empyt <li> elements in your list.";for(h=[],"A"===d.nodeName&&(i=d.getAttribute("href"),n=q(d).html(),l=1,h.push({action:"redir",url:i})),s=1;s!==l;s+=1){if(u=c[s],(p=q(u)).hasClass(v)){f=u.id||N.getId(),u.id=f,i=z+"-"+f,h.push({action:"append",srctype:z,source:"#"+f});break}if("UL"===u.nodeName){if(t)throw"Recursive error, please check your code";o=x(p.children(),!0)}p.hasClass(w)&&(n=p.html())}n=n||d.nodeValue,r.id||(r.id=N.getId()),m.push({bind:r.id,label:n,actions:h,group:o})}return m},S=function(e){var t=e.label,a="<option value='"+t+"'";return a+=l(e),a+=">"+t+"</option>"},l=function(e){var t="",a={};return a.bind=e.bind||"",a.actions=e.actions||[],t+=" data-"+z+"='"+JSON.stringify(a)+"'"},X=function(e,t,a,r,n){var i=e.label,o=N.getId(),s=" for='"+o+"'><input id='"+o+"' type='"+a+"' name='"+t+"' value='"+i+"'";return s=r?"<label class='"+a+(r?"-inline":"")+"'"+s:"<div class='"+a+"'><label"+s,s+=l(e),n&&(s+=" required='required'"),s+=" /> "+i+"</label>",r||(s+="</div>"),s};r.on(F,u+", ."+v,function(e){var t,a,r,n,i,o,s,l=e.target,c=[];if(l===e.currentTarget&&(a=(t=q(l)).data($))&&a.reset)for(r=a.reset,q.isArray(r)?c=r:c.push(r),i=c.length,n=0;n!==i;n+=1)(s=(o=c[n]).action)&&(!1!==o.live&&(o.live=!0),t.trigger(s+"."+B,o))}),r.on("change",t+" "+e,function(e){var t,a,r,n,i,o,s,l,c=e.currentTarget,d=q(c),u=d.nextAll(),p=q("#"+c.getAttribute("data-"+W)),f=q("#"+c.getAttribute(G)),h=p.data(H),b=d.find(":checked",d),g=d.get(0).form;if(n=u.length){for(r=n;0!==r;--r)(s=u[r])&&(-1<(l=h.indexOf(s.id))&&h.splice(l,1),q("#"+s.getAttribute(G)).trigger(F).trigger(P),q(s).trigger(P));p.data(H,h),u.remove()}f.trigger(F).trigger(P),d.trigger(P),d.data(_,[]);var m,v,w,y,x,k,A,j,C,E=[],S=[],I=[];for(m=p.data($),(v=f.data($))&&m&&(m=q.extend({},m,v)),b.length&&b.val()&&m&&m.default&&(a=m.default,q.isArray(a)?E=a:E.push(a)),x=m.action,k=m.prop,K=m.actionData||{},(a=d.data(V))&&(E=E.concat(a)),r=0,n=b.length;r!==n;r+=1)if(t=b.get(r),(w=N.getData(t,z))&&(C=w.bind,E=E.concat(w.actions),C&&(y=T.getElementById(C).getAttribute("data-"+z)))){if(y.startsWith("{")||y.startsWith("[")){try{a=JSON.parse(y)}catch(e){q.error("Bad JSON object "+y)}q.isArray(a)||(a=[a])}else(a={}).action=x,a[k]=y,a=[a=q.extend(!0,{},K,a)];E=E.concat(a)}if(!E.length)return!0;for(r=0,n=E.length;r!==n;r+=1)(o=(i=E[r]).target)&&o!==C?I.push(i):S.push(i);for(A=m.base||{},j=I.length,r=0,n=S.length;r!==n;r+=1)(i=q.extend({},A,S[r])).origin=f.get(0),i.provEvt=c,i.$selElm=b,i.form=g,j&&(i.actions=I),p.trigger(i.action+"."+B,i);return!0}),r.on("submit",t+" form",function(e){var t,a,r,n,i,o,s,l,c,d,u,p,f,h,b,g=e.currentTarget,m=q(g),v=m.data(H),w=m.data(J)||[],y=v?v.length:0,x=[],k=[],A=!1;for(y&&(n=(r=q("#"+v[y-1])).data(H),q("#"+n[n.length-1]).trigger(P),r.trigger(P)),a=0;a!==y;a+=1)for(d=(i=(r=q("#"+v[a])).data(H)).length,c=0;c!==d;c+=1){if(o=q("#"+i[c]),s=q("#"+o.data(W)),k.push(s),l=s.data($),!(h=o.data(_))&&l.defaultIfNone){for(u=0,p=(h=l.defaultIfNone).length;u!==p;u+=1)(f=h[u]).origin=s.get(0),f.$selElm=s.prev().find("input, select").eq(0),f.provEvt=f.$selElm.get(0),f.form=g,s.trigger(f.action+"."+B,f);h=o.data(_)}if(h)for(u=0,p=h.length;u!==p;u+=1)(f=h[u]).form=g,r.trigger(f.action+"."+U,f),x.push({$elm:r,data:f}),A=A||f.preventSubmit,b=f.provEvt}if(!A){for(m.find(L).removeAttr("name"),y=w.length,a=0;a!==y;a+=1)q(w[a]).remove();var j,C,E,S,I,T;if(w=[],(j=m.attr("action"))&&0<(C=j.indexOf("?"))){for(y=(T=j.substring(C+1).split("&")).length,a=0;a!==y;a+=1)0<(S=E=T[a]).indexOf("=")&&(S=(I=E.split("=",2))[0],E=I[1]),t=q("<input type='hidden' name='"+S+"' value='"+E+"' />"),m.append(t),w.push(t.get(0));m.data(J,w)}}for(y=k.length,a=0;a!==y;a+=1)(l=(s=k[a]).data($)).action&&x.push({$elm:s,data:l});for(y=x.length,a=0;a!==y;a+=1)(f=x[a]).data.lastProvEvt=b,f.$elm.trigger(f.data.action+"."+R,f.data);if(A)return e.preventDefault(),e.stopPropagation?e.stopImmediatePropagation():e.cancelBubble=!0,!1}),r.on("keyup",t+" select",function(e){if(-1!==navigator.userAgent.indexOf("Gecko"))return e.keyCode&&(1===e.keyCode||9===e.keyCode||16===e.keyCode||e.altKey||e.ctrlKey)||q(e.target).trigger("change"),!0}),r.on(n,u,function(e,t){var a,r,n,i,o,s,l,c,d,u,p,f,h=e.type;switch(e.namespace){case M:switch(h){case z:!function(e,t){if(e.namespace===M){var a,r,n,i,o,s,l,c=e.target,d=q(c),u=q(t.source),p=u.get(0),f=t.lblselector||"."+w,h=t.itmselector||"ul:first() > li";u.hasClass(v)&&(a=N.getData(u,z),u.data($,a),t=q.extend({},t,a)),s=t.actions||[],l=t.renderas?t.renderas:"select",p.id||(p.id=N.getId()),(n=u.children().first()).hasClass(y)?(i=n.html(),h="."+y+" + "+h):(i=(r=n.find(f)).length?r.html():u.find("> p").html(),f=null),o=x(u.find(h)),t.outputctnrid||(t.outputctnrid=t.provEvt.parentElement.id),d.trigger(l+"."+Q,{actions:s,source:p,attributes:t.attributes,outputctnrid:t.outputctnrid,label:i,lblselector:f,defaultselectedlabel:t.defaultselectedlabel,required:!t.isoptional,noreqlabel:t.noreqlabel,items:o,inline:t.inline})}}(e,t);break;case"tblfilter":!function(e,t){if(e.namespace===M){var a,r,n,i,o,s,l,c,d,u,p,f,h,b=t.column,g=t.csvextract,m=t.source,v=q(m),w=[],y=t.label,x=t.defaultselectedlabel,k=t.lblselector,A=t.fltrseq?t.fltrseq:[],j=t.limit?t.limit:10;if(!v.hasClass("wb-tables-inited"))return v.one("wb-ready.wb-tables",function(){q(e.target).trigger("tblfilter."+M,t)});if((r=v.dataTable({retrieve:!0}).api()).rows({search:"applied"}).data().length<=j)return;if(h=t.renderas?t.renderas:"select",!b&&A.length){if(!(d=A.shift()).column)throw"Column is undefined in the filter sequence";b=d.column,g=d.csvextract,x=d.defaultselectedlabel,y=d.label,k=d.lblselector}if(a=r.column(b,{search:"applied"}),g)for(o=0,s=(n=a.data()).length;o!==s;o+=1)w=w.concat(n[o].split(","));else for(o=0,s=(n=a.nodes()).length;o!==s;o+=1)for(l=0,c=(i=q(n[o]).find("li")).length;l!==c;l+=1)w.push(q(i[l]).text());w=w.sort().filter(function(e,t,a){return!t||e!==a[t-1]});var C=e.target,E=q(C),S=[],I=t.actions?t.actions:[];for(A.length&&(f={action:"append",srctype:"tblfilter",source:m,renderas:(u=A[0]).renderas?u.renderas:h,fltrseq:A,limit:j}),o=0,s=w.length;o!==s;o+=1)p={label:d=w[o],actions:[{action:"tblfilter",source:m,column:b,value:d}]},f&&p.actions.push(f),S.push(p);y=y||a.header().textContent,t.outputctnrid||(t.outputctnrid=t.provEvt.parentElement.id),E.trigger(h+"."+Q,{actions:I,source:v.get(0),outputctnrid:t.outputctnrid,label:y,defaultselectedlabel:x,lblselector:k,items:S,inline:t.inline})}}(e,t)}break;case Q:switch(h){case"select":!function(e,t){var a,r,n,i,o,s,l,c,d,u=t.outputctnrid,p=q("#"+u),f=t.actions,h=t.lblselector,b=!!t.required,g=!t.noreqlabel,m=t.items,v=e.target,w=q(v),y=t.source,x=t.attributes,k=w.data($).i18n,A=N.getId(),j="<label for='"+A+"'",C="</span>",E=t.defaultselectedlabel?t.defaultselectedlabel:k.defaultsel;if(b&&g&&(j+=" class='required'",C+=" <strong class='required'>("+k.required+")</strong>"),j+="><span class='field-name'>",C+="</label>",h?(r=(a=q("<div>"+t.label+"</div>")).find(h)).html(j+r.html()+C):a=q(j+t.label+C),n="<select id='"+A+"' name='"+O+A+"' class='full-width form-control mrgn-bttm-md "+D+"' data-"+W+"='"+v.id+"' "+G+"='"+y.id+"'",b&&(n+=" required"),x&&"object"==typeof x)for(o in x)x.hasOwnProperty(o)&&(n+=" "+o+"='"+x[o]+"'");for(n+="><option value=''>"+E+"</option>",o=0,s=m.length;o!==s;o+=1)if((d=m[o]).group){for(n+="<optgroup label='"+d.label+"'>",c=d.group.length,l=0;l!==c;l+=1)n+=S(d.group[l]);n+="</optgroup>"}else n+=S(d);i=q(n+="</select>"),p.append(a).append(i),f&&0<f.length&&i.data(V,f),Y(w,H,A)}(e,t);break;case"checkbox":t.typeRadCheck="checkbox",m(e,t);break;case"radio":t.typeRadCheck="radio",m(e,t)}break;case B:switch(h){case"append":!function(e,t){if(e.namespace===B){var a=t.srctype?t.srctype:z;if(t.container=t.provEvt.parentNode.id,!t.source)throw"A source is required to append a field flow control.";q(e.currentTarget).trigger(a+"."+M,t)}}(e,t);break;case"redir":Y(q(t.provEvt),_,t,!0);break;case"ajax":d=e,f=(u=t).provEvt,u.live?(u.container||(p=q("<div></div>"),q(f.parentNode).append(p),u.container=p.get(0)),q(d.target).trigger("ajax."+U,u)):(u.preventSubmit=!0,Y(q(f),_,u));break;case"tblfilter":!function(e,t){if(e.namespace===B){var a,r=t.source,n=q(r).dataTable({retrieve:!0}).api(),i=t.column,o=parseInt(i,10),s=!!t.regex,l=!t.smart||!!t.smart,c=!t.caseinsen||!!t.caseinsen;i=!0===o?o:i,(a=n.column(i)).search(t.value,s,l,c).draw(),q(t.provEvt).one(P,function(){a.search("").draw()})}}(e,t);break;case"toggle":t.live?g(e,t):(t.preventSubmit=!0,Y(q(t.provEvt),_,t));break;case"addClass":if(!t.source||!t.class)return;t.live?q(t.source).addClass(t.class):(t.preventSubmit=!0,Y(q(t.provEvt),_,t));break;case"removeClass":if(!t.source||!t.class)return;t.live?q(t.source).removeClass(t.class):(t.preventSubmit=!0,Y(q(t.provEvt),_,t));break;case"query":b(0,t)}break;case U:switch(h){case"redir":l=(s=t).form,(c=s.url)&&l.setAttribute("action",c);break;case"ajax":o=(a=t).clean,a.container?r=q(a.container):(n=N.getId(),r=q("<div id='"+n+"'></div>"),q(a.form).append(r),o="#"+n),o&&q(a.origin).one(P,function(){q(o).empty()}),a.trigger&&r.attr("data-trigger-wet","true"),i=a.type?a.type:"replace",r.attr("data-ajax-"+i,a.url),r.one("wb-contentupdated",function(e,t){var a=e.currentTarget,r=a.getAttribute("data-trigger-wet");a.removeAttribute("data-ajax-"+t["ajax-type"]),r&&(q(a).find(N.allSelectors).addClass("wb-init").filter(":not(#"+a.id+" .wb-init .wb-init)").trigger("timerpoke.wb"),a.removeAttribute("data-trigger-wet"))}),r.trigger("wb-update.wb-data-ajax");break;case"toggle":g(e,t);break;case"addClass":q(t.source).addClass(t.class);break;case"removeClass":q(t.source).removeClass(t.class);break;case"query":b(0,t)}}}),r.on("timerpoke.wb "+a,u,function(e){switch(e.type){case"timerpoke":case"wb-init":!function(e){var t,a,r,n,i,o=N.init(e,z,u);if(o){t=q(o),a=o.id,h.i18n[N.lang]&&(h.i18n=h.i18n[N.lang]),(r=N.getData(t,z))&&r.i18n&&(r.i18n=q.extend({},h.i18n,r.i18n)),(n=q.extend({},h,r)).defaultIfNone&&!q.isArray(n.defaultIfNone)&&(n.defaultIfNone=[n.defaultIfNone]),t.data($,n),i=n.i18n,String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e});var s,l,c,d=N.getId();if(n.noForm){for(s="<div class='mrgn-tp-md'><div id='"+d+"'></div></div>",l=o.parentElement;"FORM"!==l.nodeName;)l=l.parentElement;q(l.parentElement).addClass(p)}else s=(s="<div class='wb-frmvld "+p+"'><form><div id='"+d+"'>")+'</div><input type="submit" value="'+i.btn+'" class="btn btn-primary mrgn-bttm-md" /> </form></div>';t.addClass("hidden"),s=q(s),t.after(s),n.noForm||(l=s.find("form"),s.trigger("wb-init.wb-frmvld")),c=q(l),Y(c,H,a),n.outputctnrid||(n.outputctnrid=d),n.source||(n.source=o),n.srctype||(n.srctype=z),n.inline=!!n.inline,t.trigger(n.srctype+"."+M,n),n.unhideelm&&q(n.unhideelm).removeClass("hidden"),n.hideelm&&q(n.hideelm).addClass("hidden"),N.ready(t,z),n.ext&&(n.form=c.get(0),t.trigger(n.ext+"."+f,n))}}(e)}return!0}),N.add(u)}(jQuery,document,wb),function(f,h){"use strict";var e=h.doc,b={},g={},m=function(e,t,a,r,n,i){if(!window.jsonpointer)return setTimeout(function(){m(e,t,a,r,n,i)},100),!1;i&&(a=jsonpointer.get(a,i)),f("#"+e).trigger({type:"json-fetched.wb",fetch:{response:a,status:r,xhr:n,refId:t}},this)};e.on("json-fetch.wb",function(e){var t,a,s,r,n=e.element||e.target,l=e.fetch,i=l.url.split("#"),c=i[0],o=l.nocache,d=l.nocachekey||h.cacheBustKey||"wbCacheBust",u=i[1]||!1,p=l.refId;if(n===e.target||e.currentTarget===e.target){if(n.id||(n.id=h.getId()),s=n.id,u){if(91===(a=u.split("/")[0]).charCodeAt(0))return void f("#"+s).trigger({type:"postpone.wb-jsonmanager",postpone:{callerId:s,refId:p,dsname:a,selector:u.substring(a.length)}});l.url=c}o&&(t=d+"="+("nocache"===o?h.guid():h.sessionGUID()),c=-1!==c.indexOf("?")?c+"&"+t:c+"?"+t,l.url=c),Modernizr.load({load:"site!deps/jsonpointer"+h.getMode()+".js",complete:function(){if(!l.nocache){if(r=b[c])return void m(s,p,r,"success",void 0,u);if(g[c])return void g[c].push({callerId:s,refId:p,selector:u});g[c]=[]}f.ajax(l).done(function(e,t,a){var r,n,i,o;if(!l.nocache)try{b[c]=e}catch(e){return}if(m(s,p,e,t,a,u),g[c])for(n=(o=g[c]).length,r=0;r!==n;r+=1)i=o[r],m(i.callerId,i.refId,e,t,a,i.selector)}).fail(function(e,t,a){f("#"+s).trigger({type:"json-failed.wb",fetch:{xhr:e,status:t,error:a,refId:p}},this)},this)}})}})}(jQuery,wb),function(m,p,v){"use strict";function w(e,t,a,r){e.after('<p lang="en"><strong>JSON Manager Debug</strong> ('+t+')</p><ul lang="en"><li>JSON: <pre><code>'+JSON.stringify(a)+"</code></pre></li><li>Patches: <pre><code>"+JSON.stringify(r)+"</code></pre>")}function y(e,t,a,r){var n,i;if(m.isArray(a)||(a=[a]),m.isArray(r)||(r=[r]),n=jsonpointer.get(e,t),m.isArray(n))for(i=n.length-1;-1!==i;--i)c(n[i],a,r)||jsonpatch.apply(e,[{op:"remove",path:t+"/"+i}]);return e}var x="wb-jsonmanager",f="[data-"+x+"]",k="data-"+x+"-reload",h=[],A={},j={},C={},E={},e=v.doc,b={ops:[{name:"wb-count",fn:function(e,t,a){var r,n,i=e[t],o=0,s=this.filter||[],l=this.filternot||[];if(m.isArray(s)||(s=[s]),m.isArray(l)||(l=[l]),(s.length||l.length)&&m.isArray(i))for(r=i.length,n=0;n!==r;n+=1)c(i[n],s,l)&&(o+=1);else m.isArray(i)&&(o=i.length);jsonpatch.apply(a,[{op:"add",path:this.set,value:o}])}},{name:"wb-first",fn:function(e,t,a){var r=e[t];m.isArray(r)&&0!==r.length&&jsonpatch.apply(a,[{op:"add",path:this.set,value:r[0]}])}},{name:"wb-last",fn:function(e,t,a){var r=e[t];m.isArray(r)&&0!==r.length&&jsonpatch.apply(a,[{op:"add",path:this.set,value:r[r.length-1]}])}},{name:"wb-nbtolocal",fn:function(e,t,a){var r=e[t],n=this.locale||p.wb.lang,i=this.suffix||"",o=this.prefix||"";"string"==typeof r&&(r=parseFloat(r),isNaN(r))||jsonpatch.apply(a,[{op:"replace",path:this.path,value:o+r.toLocaleString(n)+i}])}},{name:"wb-toDateISO",fn:function(e,t,a){this.set?jsonpatch.apply(a,[{op:"add",path:this.set,value:v.date.toDateISO(e[t])}]):jsonpatch.apply(a,[{op:"replace",path:this.path,value:v.date.toDateISO(e[t])}])}},{name:"wb-toDateTimeISO",fn:function(e,t,a){this.set?jsonpatch.apply(a,[{op:"add",path:this.set,value:v.date.toDateISO(e[t],!0)}]):jsonpatch.apply(a,[{op:"replace",path:this.path,value:v.date.toDateISO(e[t],!0)}])}}],opsArray:[{name:"wb-toDateISO",fn:function(e){var t,a=this.set,r=this.path,n=e.length;for(t=0;t!==n;t+=1)a?jsonpatch.apply(e,[{op:"wb-toDateISO",set:"/"+t+a,path:"/"+t+r}]):jsonpatch.apply(e,[{op:"wb-toDateISO",path:"/"+t+r}])}},{name:"wb-toDateTimeISO",fn:function(e){var t,a=this.set,r=this.path,n=e.length;for(t=0;t!==n;t+=1)a?jsonpatch.apply(e,[{op:"wb-toDateTimeISO",set:"/"+t+a,path:"/"+t+r}]):jsonpatch.apply(e,[{op:"wb-toDateTimeISO",path:"/"+t+r}])}}],opsRoot:[],settings:{}},c=function(e,t,a){var r,n,i,o=t.length,s=a.length,l=!1;if(o||s){for(r=0;r<o;r+=1)if(n=t[r],i=d(jsonpointer.get(e,n.path),n.value),n.optional)l=l||i;else{if(!i)return!1;l=!0}if(o&&!l)return!1;for(r=0;r<s;r+=1)if(n=a[r],(i=d(jsonpointer.get(e,n.path),n.value))&&!n.optional||i&&n.optional)return!1}return!0},d=function(e,t){switch(typeof e){case"undefined":return!1;case"boolean":case"string":case"number":return e===t;case"object":if(null===e)return null===t;if(m.isArray(e)){if(m.isArray(t)||e.length!==t.length)return!1;for(var a=0,r=e.length;a<r;a++)if(!d(e[a],t[a]))return!1;return!0}var n=i(t).length;if(i(e).length!==n)return!1;for(a=0;a<n;a++)if(!d(e[a],t[a]))return!1;return!0;default:return!1}},i=function(e){if(m.isArray(e)){for(var t=new Array(e.length),a=0;a<t.length;a++)t[a]=""+a;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t};v.ie&&(Number.prototype.toLocaleString=function(e){var t,a=this.toString().split("."),r=a[0],n=a[1],i=r.length,o=i%3||3,s=r.substr(0,o),l="fr"===e,c=l?" ":",";for(t=o;t<i;t+=3)s=s+c+r.substr(t,3);return n.length&&(s=l?s+","+n:s+"."+n),s}),e.on("json-failed.wb",f,function(e){var t,a=e.target;a===e.currentTarget&&((t=m(a)).addClass("jsonfail"),v.ready(t,x))}),e.on("json-fetched.wb",f,function(e){var t,a,r,n,i,o,s,l,c,d,u,p,f=e.target,h=m(f),b=e.fetch.response,g=m.isArray(b);if(f===e.currentTarget){a="["+(t=v.getData(h,x)).name+"]",c=t.patches||[],p=t.fpath,d=t.filter||[],u=t.filternot||[],m.isArray(c)||(c=[c]),b=g?m.extend([],b):m.extend({},b),p&&(b=y(b,p,d,u)),c.length&&(g&&t.wraproot&&((o={})[t.wraproot]=b,b=o),jsonpatch.apply(b,c)),t.debug&&w(h,"initEvent",b,c);try{A[a]=b}catch(e){return}if(j[a]=t,f.hasAttribute(k)&&(f.removeAttribute(k),(o=E[a])&&h.trigger(o)),!t.wait&&C[a])for(i=(s=C[a]).length,n=0;n!==i;n+=1){if((l=(o=s[n]).selector).length)try{r=jsonpointer.get(b,l)}catch(e){throw a+" - JSON selector not found: "+l}else r=b;m("#"+o.callerId).trigger({type:"json-fetched.wb",fetch:{response:r,status:"200",refId:o.refId,xhr:null}},this)}v.ready(h,x)}}),e.on("patches.wb-jsonmanager",f,function(e){var t,a,r,n,i,o,s,l,c,d=e.target,u=m(d),p=e.patches,f=e.fpath,h=e.filter||[],b=e.filternot||[],g=!!e.cumulative;if(d===e.currentTarget&&m.isArray(p)){if(!(t=v.getData(u,x)))return!0;if(a="["+t.name+"]",d.hasAttribute(k))return E[a]=e,!0;if(!C[a])throw"Applying patched on undefined dataset name: "+a;for(r=A[a],g||(r=m.extend(!0,m.isArray(r)?[]:{},r)),f&&(r=y(r,f,h,b)),jsonpatch.apply(r,p),t.debug&&w(u,"patchesEvent",r,p),s=(i=C[a]).length,o=0;o!==s;o+=1){if((c=(l=i[o]).selector).length)try{n=jsonpointer.get(r,c)}catch(e){throw a+" - JSON selector not found: "+c}else n=r;m("#"+l.callerId).trigger({type:"json-fetched.wb",fetch:{response:n,status:"200",refId:l.refId,xhr:null}},this)}}}),e.on("postpone.wb-jsonmanager",function(e){var t,a=e.postpone,r=a.dsname,n=a.callerId,i=a.refId,o=a.selector;if(C[r]||(C[r]=[]),C[r].push({callerId:n,refId:i,selector:o}),A[r]&&!j[r].wait){if(t=A[r],o.length)try{t=jsonpointer.get(t,o)}catch(e){throw r+" - JSON selector not found: "+o}m("#"+n).trigger({type:"json-fetched.wb",fetch:{response:t,status:"200",refId:i,xhr:null}},this)}}),e.on("op.action.wb-fieldflow",".wb-fieldflow",function(e,t){var a,r,n,i,o;t.op&&(t.preventSubmit=!0,a=m(t.provEvt),r="wb-fieldflow-submit",n=t,(o=a.data(r))&&!i||(o=[]),o.push(n),a.data(r,o))}),e.on("op.submit.wb-fieldflow",".wb-fieldflow",function(e,t){var a,r=t.op,n=t.source;if(!r)return!0;m.isArray(r)?a=r:(a=[]).push(r),m(n).trigger({type:"patches.wb-jsonmanager",patches:a})}),e.on("timerpoke.wb wb-init.wb-jsonmanager",f,function(e){var t,a,r,n,i,o,s,l,c,d=v.init(e,x,f),u=p[x]||{};d&&(t=m(d),Modernizr.load({load:"site!deps/json-patch"+v.getMode()+".js",testReady:function(){return p.jsonpatch},complete:function(){var e=v.getData(t,x);if(!b.registered){if(a=b.ops.concat(u.ops||[]),r=b.opsArray.concat(u.opsArray||[]),n=b.opsRoot.concat(u.opsRoot||[]),a.length)for(i=0,o=a.length;i!==o;i++)s=a[i],jsonpatch.registerOps(s.name,s.fn);if(r.length)for(i=0,o=r.length;i!==o;i++)s=r[i],jsonpatch.registerOpsArray(s.name,s.fn);if(n.length)for(i=0,o=n.length;i!==o;i++)s=n[i],jsonpatch.registerOpsRoot(s.name,s.fn);b.settings=m.extend({},b.settings,u.settings||{}),b.registered=!0}if(!(c=e.name)||c in h)throw"Dataset name must be unique";h.push(c),(l=e.url)?(t.trigger({type:"json-fetch.wb",fetch:{url:l,nocache:e.nocache,nocachekey:e.nocachekey}}),35===l.charCodeAt(0)&&91===l.charCodeAt(1)&&v.ready(t,x)):v.ready(t,x)}}))}),v.add(f)}(jQuery,window,wb),function(r,n){"use strict";var a,i,w,o,y,s="gcweb-menu",x="."+s,e=n.doc,l=x+" [data-ajax-replace],"+x+" [data-ajax-append],"+x+" [data-ajax-prepend],"+x+" [data-wb-ajax]",c=350,d={en:"Press the SPACEBAR to expand or the escape key to collapse this menu. Use the Up and Down arrow keys to choose a submenu item. Press the Enter or Right arrow key to expand it, or the Left arrow or Escape key to collapse it. Use the Up and Down arrow keys to choose an item on that level and the Enter key to access it.",fr:"Appuyez sur la barre d'espacement pour ouvrir ou sur la touche d'échappement pour fermer le menu. Utilisez les flèches haut et bas pour choisir un élément de sous-menu. Appuyez sur la touche Entrée ou sur la flèche vers la droite pour le développer, ou sur la flèche vers la gauche ou la touche Échap pour le réduire. Utilisez les flèches haut et bas pour choisir un élément de ce niveau et la touche Entrée pour y accéder."},u=function(e){var t=r(e).parentsUntil(x).parents(),a=document.querySelector("html").className;w=-1!==a.indexOf("smallview"),o=-1!==a.indexOf("mediumview"),(w||o)&&p(!1,o),e.previousElementSibling.setAttribute("aria-label",d),n.ready(t,s)};function k(e){if("true"!==e.getAttribute("aria-expanded")){var t=e.parentElement.parentElement.querySelector("[aria-haspopup][aria-expanded=true]:not([data-keep-expanded=md-min])");t&&!w&&A(t,!0),e.setAttribute("aria-expanded","true"),i=e,setTimeout(function(){i=!1},c)}}function A(e,t){if(e){if(e.hasAttribute("aria-haspopup")||(e=e.previousElementSibling),!t){var a=e.nextElementSibling.querySelector("[role=menuitem]:focus"),r=e.parentElement.parentElement.querySelector("[role=menuitem]:focus");if(a||r===e)return}e.setAttribute("aria-expanded","false")}}function p(e,t){var a,r=document.querySelectorAll("[role=menu] [role=menu] [role=menuitem][aria-haspopup=true]"),n=r.length,i=t?"true":"false",o=e?"vertical":"horizontal",s=i;for(a=0;a<n;a++)s=r[a].nextElementSibling.querySelector("[role=menuitem]:focus")?"true":i,r[a].setAttribute("aria-expanded",s),r[a].parentElement.previousElementSibling.setAttribute("aria-orientation",o)}e.on("mouseenter",x+" ul [aria-haspopup]",function(e){var t;w||(clearTimeout(void 0),"md-min"!==(t=e.currentTarget).dataset.keepExpanded&&(clearTimeout(a),a=setTimeout(function(){k(t)},c)))}),e.on("focusin",x+" ul [aria-haspopup]",function(e){w?y=!1:k(e.currentTarget)}),e.on("mouseenter focusin",x+" [aria-haspopup] + [role=menu]",function(e){"md-min"!==e.currentTarget.previousElementSibling.dataset.keepExpanded&&(w||i===e.currentTarget||clearTimeout(void 0))}),e.on("mouseleave",x+" [aria-haspopup]",function(){clearTimeout(a)}),e.on("click",x+" [aria-haspopup]",function(e){var t,a=e.currentTarget;y?y=!1:(!w&&"BUTTON"!==a.nodeName||("true"===a.getAttribute("aria-expanded")?i!==a&&A(a,!0):(k(a),(t=a.nextElementSibling.querySelector("[role=menuitem]")).focus(),t.setAttribute("tabindex","0"))),e.stopImmediatePropagation(),e.preventDefault())}),e.on(n.resizeEvents,function(e){switch(e.type){case"xxsmallview":case"xsmallview":case"smallview":p(!(w=!0),!1);break;case"mediumview":p(w=!1,!0);break;case"largeview":case"xlargeview":default:p(!(w=!1),!0)}}),e.on("keydown",function(e){27===e.keyCode&&A(document.querySelector(x+" button"))}),e.on("keydown",x+" button, "+x+" [role=menuitem]",function(e){var t,a=e.currentTarget,r=9===(t=e.charCode||e.keyCode)?"tab":13===t||32===t?"enter":27===t?"esc":39===t?"right":37===t?"left":40===t?"down":38===t&&"up",n=document.querySelector("[role=menuitem]:focus")||a,i=n.parentElement,o=i.parentElement,s="BUTTON"===n.nodeName;if("tab"!==r)if(s&&"enter"===r&&"true"===a.getAttribute("aria-expanded"))A(a,y=!0);else{var l,c;n.nextElementSibling&&(l=n.nextElementSibling.querySelector("[role='menuitem']")),c=i.nextElementSibling?(c=i.nextElementSibling.querySelector("[role=menuitem]"))||i.nextElementSibling.nextElementSibling.querySelector("[role=menuitem]"):!w&&n.dataset.keepExpanded&&l?l:!w&&o.previousElementSibling.dataset.keepExpanded?o.parentElement.parentElement.querySelector("[role=menuitem]"):o.querySelector("[role=menuitem]");var d,u=o.previousElementSibling;d=i.previousElementSibling?(d=i.previousElementSibling.querySelector("[role=menuitem]"))||i.previousElementSibling.previousElementSibling.querySelector("[role=menuitem]"):!w&&o.lastElementChild.querySelector("[role=menuitem]").dataset.keepExpanded?o.lastElementChild.querySelector("[role=menuitem]").nextElementSibling.lastElementChild.querySelector("[role=menuitem]"):!w&&o.previousElementSibling.dataset.keepExpanded&&u?u:s?n.nextElementSibling.lastElementChild.querySelector("[role=menuitem]"):o.lastElementChild.querySelector("[role=menuitem]");for(var p,f,h,b,g,m=i;m.nextElementSibling;)if("separator"===(m=m.nextElementSibling).getAttribute("role")){p=!(!m.hasAttribute("aria-orientation")||"vertical"!==m.getAttribute("aria-orientation")),f=m.nextElementSibling.querySelector("[role=menuitem]");break}for(m=i;m.previousElementSibling;){if("separator"===(m=m.previousElementSibling).getAttribute("role")){if(b)break;h=!(!m.hasAttribute("aria-orientation")||"vertical"!==m.getAttribute("aria-orientation")),b=m.previousElementSibling}b=b&&m}if(b=b&&b.querySelector("[role=menuitem]"),s||n.setAttribute("tabindex","-1"),"down"===r&&c)g=c;else if("up"===r&&d)g=d;else if(!s&&"right"===r&&l||"enter"===r&&l)g=l;else if(p&&"right"===r)g=f;else if(h&&"left"===r)g=b;else if(!s&&"left"===r||!s&&"esc"===r)g=u;else if("tab"===r)return;if("left"!==r&&"esc"!==r||(!s&&w&&"true"===g.getAttribute("aria-expanded")?g.setAttribute("aria-expanded","false"):s&&a.setAttribute("aria-expanded","false")),g){if(w||s){var v=g.parentElement.parentElement.previousElementSibling;"true"!==v.getAttribute("aria-expanded")&&k(v)}g.setAttribute("tabindex","0"),g.focus(),e.stopImmediatePropagation(),e.preventDefault()}}else A(document.querySelector(x+" button"),!0)}),e.on("ajax-fetched.wb ajax-failed.wb",l,function(e){var t=e.target;e.currentTarget===t&&u(t)}),e.on("timerpoke.wb wb-init.gcweb-menu",x,function(e){var t=n.init(e,s,x);t&&(d[n.lang]?d=d[n.lang]:d.en&&(d=d.en),t.querySelector(l)||u(t.querySelector("[role=menu]")))}),n.add(x)}(jQuery,wb),function(s,l,c){"use strict";var d,u="wb-urlmapping",r="[data-"+u+"]",n="domapping."+u,i=c.doc;i.on(n,r,function(e){var t,a,r,n=s(e.target),i=function(){for(var e={},t=/\+/g,a=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},n=l.location.search.substring(1),i=a.exec(n);i;)e[r(i[1])]=r(i[2]),i=a.exec(n);return e}(),o=s.extend({},l[u]||{},c.getData(n,u));for(t in i)if("object"==typeof(r=o[t+"="+(a=i[t])]||o[t])&&(n.trigger({type:"do.wb-actionmng",actions:{action:"withInput",actions:r,cValue:a,dntwb:n[0]!==d}}),!o.multiplequery))break}),i.on("timerpoke.wb wb-init.wb-urlmapping",r,function(e){var t,a=c.init(e,u,r);a&&(t=s(a),d=d||a,c.ready(t,u),c.isReady?t.trigger(n):i.one("wb-ready.wb",function(){t.trigger(n)}))}),c.add(r)}(jQuery,window,wb),function(a,o){"use strict";function n(e){0<e.length&&a(this).trigger({type:"ajax-fetch.wb",fetch:{url:o.pageUrlParts.protocol+"//clients1.google.com/complete/search?client=partner&sugexp=gsnos%2Cn%3D13&gs_rn=25&gs_ri=partner&partnerid="+window.encodeURIComponent("008724028898028201144:knjjdikrhq0+lang:"+o.lang)+"&types=t&ds=cse&cp=3&gs_id=b&hl="+o.lang+"&q="+encodeURI(e),dataType:"jsonp",jsonp:"callback"}})}var e=o.doc,t="#wb-srch-q",s=a(t),l=a("#"+s.attr("list"));e.on("change keyup",t,function(e){var t=e.target,a=e.target.value,r=e.which;switch(e.type){case"change":n.call(t,a);break;case"keyup":e.ctrlKey||e.altKey||e.metaKey||(32===r||47<r&&r<91||95<r&&r<112||159<r&&r<177||187<r&&r<223)&&n.call(t,a)}}),e.on("ajax-fetched.wb",t,function(e){var t,a,r=e.fetch.response[1],n=r.length,i="";for(l.empty(),t=0;t<n;t+=1)i+='<option label="'+(a=r[t])[0]+'" value="'+a[0]+'"></option>';o.ielt10&&(i="<select>"+i+"</select>"),l.append(i),s.trigger("wb-update.wb-datalist")}),window["wb-data-ajax"]={corsFallback:function(e){return e.url=e.url.replace(".html",".htmlp"),e}},a("[data-reveal]").change(function(){var e=a(this),t=e.attr("data-reveal");return e.is(":checked")?a(t).removeClass("hide"):a(t).addClass("hide")})}(jQuery,(document,wb)),function(f,u,l){"use strict";function o(e){if("click"===e.type)return 1;if("keypress"===e.type){var t=e.charCode||e.keyCode;return 32===t||13===t}}var t,c=(t=new RegExp("{{\\s*([a-z0-9_$][\\.a-z0-9_]*)\\s*}}","gi"),function(e,c,d){return e.replace(t,function(e,t){for(var a,r,n,i=t.split("."),o=i.length,s=c,l=0;l<o;l+=1){if(void 0===(s=s[i[l]]))throw"tim: '"+i[l]+"' not found in "+e;if(l===o-1)return f.isNumeric(s)&&d?(a=s,r=d,n=Math.pow(10,r||0),Math.round(a*n)/n).toLocaleString(u.documentElement.lang):f.isNumeric(s)?s.toLocaleString(u.documentElement.lang):s}})});function s(e,r,t,n){var a=f('[data-wbtbl-search$="@'+t+"@"+n+'"],[data-wbtbl-highlight$="@'+t+"@"+n+'"]');r?a.removeClass("pick"):a.addClass("pick"),f('form[data-wb5-bind="#'+e.table().node().id+'"]').find('[value^="'+t+"@"+n+'"],[data-wbtbl-bind^="'+t+"@"+n+'"]').each(function(e,t){var a=f(t);return a.is("[type=checkbox],[type=radio]")?a.prop("checked",r):a.is("[type=text],[type=textarea]")?a.val(r?n:""):a.get(0).selected=r,!0})}function d(){var e=f(this),r=[],t=e.relatives().DataTable(),a=e.command(this.getAttribute("data-wbtbl-post")),n=[];if(e.find(a.selector).each(function(e,t){var a=f(t);if(a.is("[type=checkbox]")){if(a.is(":checked")){if(a.is("[data-xor]"))return n.push(a.val()),!0;r.push(a.val())}return!0}r.push(a.val())}),1<n.length){for(var i={},o=!1,s=n.length-1;0<=s;s--){var l=n[s].split("@");i.hasOwnProperty(l[0])||(i[l[0]]=[]),i[l[0]].push("("+l[1]+")")}for(var o in i)r.push(o+"@"+i[o].join("|"))}else 1===n.length&&r.push(n[0]);for(var c=r.length-1;0<=c;c--){var d=r[c].split("@"),u=d[0],p=d[1];-1===p.indexOf("|")?(p=p.replace(/^\(/,"").replace(/\)$/,""),t.column(u).search(p)):t.column(u).search(p,!0)}}f.fn.extend({relatives:function(){var a=f();return this.each(function(e,t){t.wb5&&t.wb5.relatives&&t.wb5.relatives.each(function(){a=a.add(this)})}),a},related:function(a,r){return this.each(function(e,t){r&&t.wb5&&t.wb5.relatives&&t.wb5.relatives.each(function(){a=a.add(this)}),f.extend(t,{wb5:{relatives:a}})}),this}}),f.fn.extend({shuffle:function(){var a=this.get(),t=f.map(a,function(){var e=Math.floor(Math.random()*a.length),t=f(a[e]).clone(!0)[0];return a.splice(e,1),t});return this.each(function(e){f(this).replaceWith(f(t[e]))}),f(t)}}),f.fn.extend({rand:function(e){var t=this,a=t.size();if(a<(e=e?parseInt(e):1))return t.pushStack(t);if(1==e)return t.filter(":eq("+Math.floor(Math.random()*a)+")");r=t.get();for(var n=0;n<a-1;n++){var i=Math.floor(Math.random()*(a-n))+n;r[i]=r.splice(n,1,r[i])[0]}return r=r.slice(0,e),t.filter(function(e){return-1<f.inArray(t.get(e),r)})}}),f.fn.extend({notEmpty:function(){return 0!==this.length}}),f.fn.extend({command:function(e){if(e.length){var t=e.split("@");return{command:t[0],selector:t[1],options:t[2]}}return{command:!1,selector:!1}}}),f("[data-wb5-bind]").each(function(e,t){var a,r=f(t);r.parents().is("template")||(a=f(r.attr("data-wb5-bind"))).notEmpty()&&r.related(a)}),f(u).on("keypress click","[data-wb5-debug]",function(e){if(!o(e))return!0;for(var t=f(this),a=t.attr("data-wb5-debug").split(","),r=a.length-1;0<=r;r--)console.log(t[a[r]]())}),f(u).on("preInit.dt",".wb-tables",function(){var e=f("form[data-wbtbl-post]").get(0);e&&d.call(e)}),f(u).on("draw.dt",".wb-tables",function(e){var t=f(this),a=t.DataTable();t.relatives().trigger({type:e.type,table:a,displayed:a.page.info().recordsDisplay,total:a.page.info().recordsTotal})}),Modernizr.details||f(u).on("draw.dt",".wb-tables",function(e){f(this).find("summary").removeClass("wb-init").removeClass("wb-details-inited").trigger("wb-init.wb-details")}),f(u).on("draw.dt","[data-wbtbl-draw]",function(e){var t,a,r=f(this),n=r.command(r.attr("data-wbtbl-draw")),i=e.table,o=f(i.table().node()),s=e.displayed!==e.total,l=0,c=e.total;e.displayed;switch(n.command){case"display":return t=r,a=i.page.info()[n.options],t.is(":input")?t.val(a):t.text(a),!0;case"count":if((s?i.rows({search:"applied"}):i.rows({page:"all"})).iterator("row",function(e,t){-1<f(this.row(t).node()).text().indexOf(n.options)&&l++}),r.is("progress")){if(r.attr({max:c,value:l}),o.hasClass("wbtbl-silent"))return!0;r.trigger("updated.wb5")}return r.text(l)}}),f("[data-wbtbl-reset]").on("click",function(e){var t=this.getAttribute("data-wbtbl-reset").split("@"),a=f(t[0]).DataTable();return a.search("").columns().search(""),"all"===t[1]?a.search("").columns().search("").draw():a.column(t[1]).search("").draw()}),f(u).on("wb-ready.wb-tables","[data-wbtbl-tag=enable]",function(){var e=f(this),t=e.closest(".dataTables_wrapper");t.addClass("tagcloud").find(".top").append('<div data-wbtbl-tagcloud="active" aria-live="polite"></div>'),e.related(t.find("[data-wbtbl-tagcloud]").eq(0),!0),t.find("[data-wbtbl-tagcloud]").eq(0).trigger({type:"draw.dt",table:e.eq(0).dataTable().api()})}),f(u).on("draw.dt","[data-wbtbl-tagcloud]",function(e){function t(){var e=this.search();if(e){var t=e.split("|"),a='<li><span class="tagitem" data-wbtbl-col-idx="'+r+'"><span class="content">'+t.map(function(e){return e.replace(/[{()}]/g,"")}).join(" &amp; ")+'</span> <button type="button" class="close" tabindex="0" aria-label="'+l.i18n("geo-aoi-btnclear")+'"><span aria-hidden="true">&times;</span></button></span></li>';n.find("ul").append(a)}r++}var a=e.table,r=-1,n=f(this);n.html('<ul class="list-inline tags" aria-live="polite"></ul><div class="clearfix"></div>'),t.call(a),a.columns().every(t)}),f(u).on("updated.wb5","[data-wb5-update]",function(e){var t=f(this).relatives(),a=this.getAttribute("max"),r=this.getAttribute("value"),n=(this.getAttribute("data-percentage"),Math.ceil(r/a*100)||0);t.find(".meter").text(r),t.removeClass(function(e,t){return(t.match(/(^|\s)p\d+/g)||[]).join(" ")}).attr("data-percentage","p"+n),t.addClass("p"+n)}),f(u).on("keypress click","[data-wbtbl-highlight]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wbtbl-highlight")),r=t.relatives().DataTable();t.relatives().removeClass("wbtbl-silent").addClass("wbtbl-silent"),r.column(a.selector).search(a.options,!1,!1,!0).draw()}),f(u).on("keypress click","[data-wbtbl-search]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wbtbl-search")),r=t.relatives().DataTable();t.relatives().removeClass("wbtbl-silent"),r.search("").columns().search(""),r.column(a.selector).search(a.options,!1,!1,!0).draw()}),f(u).on("submit","[data-wbtbl-submit]",function(e){var t=f(this),a=t.command(this.getAttribute("data-wbtbl-submit")),r=t.relatives().DataTable(),n=a.selector,i=a.options;return t.relatives(),r.search("").columns().search(""),n&&(r=r.column(n)),r.search(t.find("input").val(),!1,i&&"smart"===i,!0).draw(),!1}),f(u).on("keypress click","[data-wb5-ajax]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wb5-ajax")),r=t.relatives();switch(r.attr("aria-live","polite"),a.command){case"replace":f.get(a.options,function(e){r.html(e)})}}),f(u).on("keypress click","[data-wb5-load]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wb5-load")),r=t.relatives();switch(r.attr({"aria-relevant":"all","aria-live":"polite","aria-atomic":"true"}),a.command){case"replace":r.load(a.options)}}),f(u).on("keypress click","[data-wb5-trigger]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wb5-trigger"));t.relatives().trigger(a.command)}),f(u).on("keypress click","[data-wb5-profile]",function(e){if(!o(e))return!0;var t=f(this),a=t.command(this.getAttribute("data-wb5-profile"));"single"===a.command&&(t.relatives().removeClass(a.options).filter("[role=button]").attr("aria-pressed","false"),f(e.target).closest(t.relatives()).addClass(a.options).filter("[role=button]").attr("aria-pressed","true"))}),f(u).on("keypress click","[data-wbtbl-tagcloud] li button",function(e){if(!o(e))return!0;var t=f(this),a=t.closest("li"),r=a.find(".content").text(),n=parseInt(t.closest("[data-wbtbl-col-idx]").attr("data-wbtbl-col-idx")),i=t.closest(".dataTables_wrapper").find(".wb-tables").removeClass("wbtbl-silent").DataTable();-1!==n&&(i=i.column(n)),i.search("",!1,!1,!0).draw(),a.remove(),s(i,!1,n,r)}),f(u).on("refreshCtrl.wbtbl","table",function(e){var t,a,r,n;t=f(e.currentTarget).DataTable(),a=void 0===e.isSelected||e.isSelected,r&&n?s(t,a,r,n):t.columns().every(function(e){n=t.column(e).search(),s(t,a&&n,e,n)})}),f(u).on("submit","[data-wbtbl-post]",function(e){var t=f(this);return d.call(this),t.relatives().DataTable().draw(),!!t.is("[action]")}),f(u).on("reset","[data-wbtbl-post]",function(e){var n=this,i=f(n).relatives().DataTable();i.search(""),i.columns().every(function(){this.search("")}),i.draw(),setTimeout(function(){var e,t,a=n.querySelectorAll("[data-wb5-default-checked]"),r=a.length;for(e=0;e<r;e++)(t=a[e]).checked="false"!==t.dataset.wb5DefaultChecked;d.call(n),i.draw()},1)}),f("[data-wb5-click]").on("click",function(){var e=f(this).data("wb5-click").split("@"),t=e[0],a=(e[1],e[2]);if("postback"===t){var r=f(e[1]);return f.ajax({type:r.attr("method"),url:r.attr("action"),data:r.serialize()}),!a.block}}),f("[data-wb5-randomize]").each(function(){var e,t=f(this),a=t.data("wb5-randomize").split("@"),r=a[0],n=a[1],i=2<a.length?JSON.parse(a[2]):{};return"self!"===n.substring(0,5)&&(n=n.substr(5),e=t),"shuffle"===r&&f(n,e).shuffle(),"toggle"===r&&f(n,e).rand(i.number).toggleClass(i.classes),!0}),f(u).on("wb-ready.wb-charts","[data-wb-charts-interactive]",function(){var e=f(this),t=e.command(this.getAttribute("data-wb-charts-interactive")),i=l.getId().replace(/-/g,""),o=f(t.selector).html(),s=t.options?t.options:1,a=e.prev();f("<div id='"+i+"' class='wbchrt-tpl'></div>").css({position:"absolute",display:"none"}).appendTo("body"),f("canvas:eq(1)",a).css("position","relative"),a.on("plothover",function(e,t,a){if(a){var r=f("#"+i),n={x:a.datapoint[0],y:a.datapoint[1],label:a.series.label,formatted:{}};r.html(c(o,n,s)),r.css({top:a.pageY+7,left:a.pageX+7}).show()}else f("#"+i).hide()})})}(jQuery,document,wb),function(x,k,A){"use strict";function j(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function o(e){var t=e.target,a=k.getElementById(t.getAttribute("list"));Modernizr.load({test:Modernizr.stringnormalize,nope:["site!deps/unorm"+A.getMode()+".js"]}),x(a).trigger({type:"json-fetch.wb",fetch:{url:a.dataset.wbSuggest}})}function s(e){var t=e.target,a=k.getElementById(t.getAttribute("list")),r=e.target.value,n=e.which;switch(C&&clearTimeout(C),e.type){case"change":C=setTimeout(S.bind(a,r),250);break;case"keyup":e.ctrlKey||e.altKey||e.metaKey||(8===n||32===n||47<n&&n<91||95<n&&n<112||159<n&&n<177||187<n&&n<223)&&(C=setTimeout(S.bind(a,r),250))}}var C,l=A.doc,c="wb-suggest",d="[data-"+c+"]",E=5,S=function(e,t,a){var r,n,i,o,s,l,c,d,u,p=a||JSON.parse(this.dataset.wbSuggestions||[]),f=this.dataset.wbFilterType||"any",h=p.length,b=[],g=this.childNodes,m=g.length-1,v=x("[list="+this.id+"]"),w=v.get(0);if(!p.length&&E&&(--E,C&&clearTimeout(C),C=setTimeout(S(e,t,a),250)),t=t||parseInt(this.dataset.wbLimit||h),e){switch(f){case"startWith":e="^"+e;break;case"word":e="^"+e+"|\\s"+e}r=new RegExp(e,"i")}if(!e||e.length<2)(function(){var e,t,a=this.children;for(t=a.length-1;0<t;--t)1===(e=a[t]).nodeType&&"TEMPLATE"!==e.nodeName&&this.removeChild(e)}).call(this),g=[];else for(c=m;0!==c;--c)1===(d=g[c]).nodeType&&"OPTION"===d.nodeName&&((u=d.getAttribute("value"))&&u.match(r)?b.push(j(u)):this.removeChild(d));var y=this.querySelector("template");for(y&&!y.content&&A.tmplPolyfill(y),n=0;n<h&&b.length<t;n+=1)i=p[n],o=j(i),-1!==b.indexOf(o)||e&&!i.match(r)||(b.push(o),y?l=(s=y.content.cloneNode(!0)).querySelector("option"):(s=k.createDocumentFragment(),l=k.createElement("OPTION"),s.appendChild(l)),l.setAttribute("label",i),l.setAttribute("value",i),this.appendChild(s));v.trigger("wb-update.wb-datalist"),w.value=w.value};l.on("timerpoke.wb wb-init.wb-suggest json-fetched.wb",d,function(e){var t,a,r,n=e.type,i=e.target;if(e.currentTarget===i)switch(n){case"timerpoke":case"wb-init":t=e,a=A.init(t,c,d),r="[list="+t.target.id+"]",a&&(Modernizr.addTest("stringnormalize","normalize"in String),l.one("focus",r,o),(a.dataset.wbLimit||a.dataset.wbFilterType)&&l.on("change keyup",r,s),A.ready(x(a),c));break;case"json-fetched":(function(e){this.dataset.wbSuggestions=JSON.stringify(e),delete this.dataset.wbSuggest,S.call(this,k.querySelector("[list="+this.id+"]").value)}).call(i,e.fetch.response)}return!0}),A.add(d)}(jQuery,document,wb),function(I,g,m,T){"use strict";function c(e,t){for(var a=m.getElementById(e.getAttribute("aria-controls")),r=I(e).parent(),n=I(e);!n.hasClass("wb5React");)n=n.parent();var i,o,s=C[n.get(0).id],l=a.getAttribute("data-wb5-template");if(l&&(i=s.template(l)||m.getElementById(l)||s.tmplDefault(l)),!i||!l)throw"No template defined to show listbox options";s.template(l,i),R(i),o=i.content.cloneNode(!0),s.data.filter=e.value,q=[],N(o,s,l),o.querySelectorAll("[role=option]").length?(a.innerHTML="",a.appendChild(o),I(a).removeClass("hidden"),d=r.get(0)):d&&P()}function r(e){if(l(e),document.activeElement!==e){for(var t=I(e).parent(),a=I(e);!a.hasClass("wb5React");)a=a.parent();for(var r=C[a.get(0).id],n=e.value,i={},o=r.data.options,s=0;s<o.length;s++)if(n===o[s].value){i=o[s];break}t.trigger("wb.change",{value:e.value,item:i})}}var v,d,u,w="wb-combobox",y="."+w,e=T.doc,x={template:'<div class="combobox-wrapper"><div role="combobox" aria-expanded="false" aria-haspopup="listbox" data-wb5-bind="aria-owns@popupId"><input autocomplete="off" data-rule-fromListbox="true" data-wb5-bind="id@fieldId, aria-controls@popupId, value@filter" aria-autocomplete="list" aria-activedescendant="" /></div><div data-wb5-bind="id@popupId" role="listbox" class="hidden"><template data-slot-elm="" data-wb5-template="sub-template-listbox"><ul class="list-unstyled mrgn-bttm-0">\x3c!-- <li class="brdr-bttm" role="option" data-wb5-for="option in wbLoad" data-wb5-if="!parent.filter.length || parent.config.compareLowerCase(option,parent.filter)" data-wb5-on="select@select(option); live@parent.nbdispItem(wb-nbNode)" >{{ option }}</li> --\x3e<li class="" role="option" data-wb5-for="option in options" data-wb5-if="!parent.filter.length || parent.config.compareLowerCase(option.value,parent.filter)" data-wb5-on="select@select(option.value); live@parent.nbdispItem(wb-nbNode)" >{{ option.textContent }}</li></ul></template></div></div>',i18n:{en:{errValid:"You need to choose a valid options."},fr:{errValid:"Veuillez choisir une option valide."}},compareLowerCase:function(e,t){return-1!==e.toLowerCase().indexOf(t.toLowerCase())},similarText:function(e,t,a){function h(e,t){for(var a=[],r=0;r<=e.length;r++){for(var n=r,i=0;i<=t.length;i++)if(0===r)a[i]=i;else if(0<i){var o=a[i-1];e.charAt(r-1)!==t.charAt(i-1)&&(o=Math.min(Math.min(o,n),a[i])+1),a[i-1]=n,n=o}0<r&&(a[t.length]=n)}return a[t.length]}var r=function(e,t){e=e.replace(/[\-\/]|_/g," ").replace(/[^\w\s]|_/g,"").trim().toLowerCase(),t=t.replace(/[\-\/]|_/g," ").replace(/[^\w\s]|_/g,"").trim().toLowerCase();var a=e.split(" "),r=t.split(" ");if(e.length>t.length&&(a=t.split(" "),r=e.split(" ")),!r.length||!a.length)return 100;for(var n=0,i=0,o="",s="",l=0;l<a.length;l++){for(var c=0,d=0,u=!1,p=0;p<r.length;p++)if(s=a[l],0<=(o=r[p]).indexOf(s)){var f=o.length;(!u||f<c)&&(c=o.length,d=o.length),u=!0}else u||c<(f=o.length-h(s,o))&&(c=f,d=o.length);n+=c,i+=d}return 0===n?0:n/i*100}(e,t);return(a=parseInt(a))<=r}},p=9,f=13,h=27,b=35,k=36,A=38,j=40,C={},E=m.createDocumentFragment(),q=[],N=function(t,a,e){var r,n=t.childNodes,i=n.length,o=[];for(m=0;m<i;m++){if(3===(r=n[m]).nodeType&&-1!=r.textContent.indexOf("{{")){r.textContent=r.textContent.replace(/{{\s?([^}]*)\s?}}/g,function(e,t){return U(a.data,t.trim())})}if("TEMPLATE"!==r.nodeName){if(1===r.nodeType)if(r.hasAttribute("data-wb5-for")){var s=z(r,"data-wb5-for"),l=B(s),c=U(a.data,l.for);if(!c)throw"Iterator not found";var d=c.length,u=0;for(c.wbLen=parseInt(d),I.isArray(c)&&(c.active=u),m=0;m<d;m++){var p=r.cloneNode(!0),f=L(p),h={"wb-idx":m,"wb-nbNode":u,parent:a.data};h[l.alias]=c[m],h=F(h),e&&(a.data[e]=h),f.if&&!D(f.if,h.data,a.data)||(u+=1,N(p,h,e),t.appendChild(p))}c.wbActive=u,o.push(r)}else r.hasAttribute("data-wb5-if")||r.hasAttribute("data-wb5-else")||r.hasAttribute("data-wb5-ifelse"),N(r,a,e)}else{R(r);var b=z(r,"data-wb5-template");b=b||T.getId(),r.parentNode.hasAttribute("data-wb5-template")||r.parentNode.setAttribute("data-wb5-template",b),a.tmplDefault(b,r)}}for(i=o.length,m=0;m!==i;m+=1)t.removeChild(o[m]);if(1===t.nodeType&&t.hasAttribute("data-wb5-bind"))for(var g=z(t,"data-wb5-bind").split(", "),m=0;m<g.length;m++){var v=g[m].split("@");t[v[0]]?(t[v[0]]=U(a.data,v[1]),a.observe(v[1],function(e){return t[v[0]]=U(a.data,v[1])||""})):(t.setAttribute(v[0],U(a.data,v[1])),a.observe(v[1],function(e){return void 0!==t[v[0]]?t[v[0]]=U(a.data,v[1])||"":t.setAttribute(v[0],U(a.data,v[1]))||""}))}if(1===t.nodeType&&t.hasAttribute("data-wb5-text")){var w=z(t,"data-wb5-text");t.textContent=U(a.data,w),a.observe(w,function(e){return t.textContent=U(a.data,w)||""})}if(1===t.nodeType&&t.hasAttribute("data-wb5-on")){var y=z(t,"data-wb5-on").split("; ");i=y.length;for(m=0;m<i;m++){var x,k,A=y[m].split("@"),j=A[0],C=A[1],E=C.indexOf("("),S=C.lastIndexOf(")");if(E&&S&&(x=C.substring(0,E).trim(),k=C.substring(E+1,S).trim()),!x)throw"Error, an event handler need to call a function";k=k&&O(k,a.data),"live"===j?U(a.data,x).call(a.data,k):q.push({nd:t,evt:j,trigger:x,attr:k})}}},z=function(e,t){var a=e.getAttribute(t);return e.removeAttribute(t),a},D=function(e,t,a){return!!O(e,t,a)},O=function(e,n,i){var o=/{{-\s?([^}]*)\s?-}}/g,s=[];return e=(e=(e=e.replace(/"([^"\\]*(\\.[^"\\]*)*)"|\'([^\'\\]*(\\.[^\'\\]*)*)\'/g,function(e,t){var a="{{-"+s.length+"-}}";return s.push(e),a})).replace(/[a-zA-Z]([^\s]+)/g,function(e,t){var a,r=e.trim();r=r.replace(o,function(e,t){return s[t]});try{a=U(n,r)}catch(e){try{a=U(i,r)}catch(e){throw"Information in the DATA obj not found"}}return"object"==typeof a&&(a=JSON.stringify(a)),"string"==typeof a?'"'+a+'"':a})).replace(o,function(e,t){return s[t]}),new Function("return "+e)()},L=function(e){var t={},a=z(e,"data-wb5-if");if(a)t.if=a,n(t,{exp:a,block:e});else{null!=z(e,"data-wb5-else")&&(t.else=!0);var r=z(e,"data-wb5-elseif");r&&(t.elseif=r)}return t},n=function(e,t){e.ifConditions||(e.ifConditions=[]),e.ifConditions.push(t)},S=function(e,t){var a,r,n=e.options,i=n.length;for(a=0;a<i;a++)r=n[a],t.data.options.push({value:r.value,textContent:r.textContent});t.data.fieldId=e.id||T.getId(),t.data.fieldName=e.name,t.data.mustExist=!0},M=function(e,t){var a,r=node.childNodes,n=r.length;for(a=0;a<n;a++)r[a]},B=function(e){var t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,a=e.match(/([^]*?)\s+(?:in|of)\s+([^]*)/);if(a){var r={};r.for=a[2].trim();var n=a[1].trim().replace(/^\(|\)$/g,""),i=n.match(t);return i?(r.alias=n.replace(t,""),r.iterator1=i[1].trim(),i[2]&&(r.iterator2=i[2].trim())):r.alias=n,r}},U=function(e,t){var a=(t=t.trim()).substring(0,1),r=t.substring(-1);if("'"===a||'"'===a||"'"===r||'"'===r)return t.substring(1,t.length-1);var n=t.indexOf("("),i=t.lastIndexOf(")"),o=[];if(-1!==n&&-1!==i&&n+1!==i){var s,l,c,d=t.substring(0,n);for(c=(o=t.substring(n+1,i).split(",")).length,s=0;s<c;s+=1){l=o[s];var u=U(e,l);o[s]=u}t=d+"()"}var p,f,h,b=t.split("."),g=b.length;for(p=0;p<g;p+=1){if(f=b[p],!e)return;e=-1!==f.lastIndexOf("()")?(h=f.substring(0,f.length-2),"string"==typeof e?String.prototype[h].apply(e,o):e[h].apply(e,o)):e[f]}return e},R=function(e){if(!e.content){var t,a,r=e;for(t=r.childNodes,a=m.createDocumentFragment();t[0];)a.appendChild(t[0]);r.content=a}},P=function(){if(d){var e=d.getAttribute("aria-owns");I("#"+e).addClass("hidden"),d=null}},l=function(e){var t=e.form&&e.form.parentNode.classList.contains("wb-frmvld");if(null===e.getAttribute("required")&&""===e.value||null===e.getAttribute("data-rule-mustExist"))return e.setCustomValidity(""),t&&I(e).valid(),!0;for(var a=I(e);!a.hasClass("wb5React");)a=a.parent();var r,n,i=C[a.get(0).id],o=e.getAttribute("aria-controls"),s=(m.getElementById(o),i.data.options),l=e.value,c=s.length;for(r=0;r<c;r+=1)if(l===s[r].value){n=!0;break}return n?(e.setCustomValidity(""),t&&I(e).valid(),!0):(e.setCustomValidity(v.errValid),t&&I(e).valid(),!1)};function F(e){var a={},r={},n={};return function(e){for(var t in e)e.hasOwnProperty(t)&&o(e,t)}(e),{data:e,observe:t,notify:i,template:function(e,t){{if(!t)return r[e]||!1;r[e]=t}},tmplDefault:function(e,t){{if(!t)return n[e]||!1;n[e]=t}},debug_signals:a};function t(e,t){a[e]||(a[e]=[]),a[e].push(t)}function i(e){!a[e]||a[e].length<1||a[e].forEach(function(e){return e()})}function o(e,t,a){var r=e[t];if(Array.isArray(r))return r.wbLen=parseInt(r.length),r.wbActive=0,o(r,"wbLen",t),void o(r,"wbActive",t);Object.defineProperty(e,t,{get:function(){return r},set:function(e){r=e,i(a?a+"."+t:t)}})}}e.on("wb-ready.wb",function(e){I.validator&&I.validator.addMethod("fromListbox",function(e,t){return t.checkValidity()},"You need to choose a valid options")}),e.on("json-fetched.wb","[role=combobox]",function(e){for(var t=e.target,a=e.fetch.response,r=I(t);!r.hasClass("wb5React");)r=r.parent();C[r.get(0).id].data.wbLoad=a}),e.on("click vclick touchstart focusin","body",function(e){d&&!d.parentElement.contains(e.target)&&setTimeout(function(){P()},1)}),e.on("focus","[role=combobox] input",function(e,t){d||setTimeout(function(){c(e.target)},1)}),e.on("blur","[role=combobox] input",function(e,t){r(e.target)}),e.on("keyup","[role=combobox] input",function(e){var t=e.which||e.keyCode,a=e.target.classList.contains("error");switch(t){case A:case j:case h:case f:case k:case b:e.preventDefault();case p:return void(a&&setTimeout(function(){r(e.target)},100));default:setTimeout(function(){c(e.target),a&&r(e.target)},100)}}),e.on("keydown","[role=combobox] input",function(e){var t=e.which||e.keyCode,a=e.target;if(t!==h){var r;d||c(a);var n=a.getAttribute("aria-activedescendant"),i=n?m.getElementById(n):null,o=m.getElementById(a.getAttribute("aria-controls")).querySelectorAll("[role=option]"),s=o.length,l=-1;if(i){for(l=0;l<s&&o[l].id!==i.id;l++);s<=l&&(l=-1)}switch(t){case A:-1===l?l=s-1:0!==l?l--:l=s-1;break;case j:-1===l?l=0:l<s&&l++;break;case k:l=0;break;case b:l=s-1;break;case f:return I(o[l]).trigger("wb.select"),P(),void e.preventDefault();case p:return u&&I(o[l]).trigger("wb.select"),void P();default:return}e.preventDefault(),r=o[l],i&&i.setAttribute("aria-selected","false"),r?(r.id||(r.id=T.getId()),a.setAttribute("aria-activedescendant",r.id),r.setAttribute("aria-selected","true"),u=!0):a.setAttribute("aria-activedescendant","")}else P()}),e.on("mouseover","[role=listbox] [role=option]",function(e,t){var a=d.querySelector("input"),r=e.target,n=a.getAttribute("aria-activedescendant"),i=n?m.getElementById(n):null;i&&i.setAttribute("aria-selected","false"),r.id||(r.id=T.getId()),i&&i.id!==r.id&&(u=!1),r.setAttribute("aria-selected","true"),a.setAttribute("aria-activedescendant",r.id)}),e.on("click","[role=listbox] [role=option]",function(e,t){var a=I(d.querySelector("input"));I(e.target).trigger("mouseover").trigger("wb.select"),a.trigger("focus"),P()}),e.on("wb.select","[role=listbox] [role=option]",function(e,t){for(var a=e.target,r=m.querySelector("[aria-activedescendant="+a.id+"]"),n=I(r);!n.hasClass("wb5React");)n=n.parent();var i,o,s=C[n.get(0).id];for(i=0;i<q.length;i++)if((o=q[i]).nd.isEqualNode(a)){s.data[o.trigger].call(s.data,o.attr);break}}),e.on("timerpoke.wb wb-init.wb-combobox",y,function(e,t){var a,r,n,i,o,s=T.init(e,w,y);if(s){a=I(s),r=I.extend(!0,{},x,g[w],T.getData(a,w)),v=v||r.i18n[T.lang];var l=F(t||(o=r,{popupId:T.getId(),fieldId:!1,fieldName:"",mustExist:!1,filter:"",cntdisplayeditem:0,options:[],config:o,i18n:{},horay:"testMe",select:function(e){this.filter=e},nbdispItem:function(e){this.cntdisplayeditem=e}}));s.id||(s.id=T.getId()),r.parserUI&&"function"==typeof r.parserUI?r.parserUI(s,l):r.parserUI&&I.isArray(r.parserUI)&&r.parserUI[s.id]?r.parserUI[s.id].call(this,s,l):(i=l,"SELECT"===(n=s).nodeName?S(n,i):"INPUT"===n.nodeName&&M(n,i)),l.data.fieldId||(l.data.fieldId=T.getId());var c,d=function(e,t){var a,r,n=t.templateID;if(n&&(a=m.getElementById(n)),a)R(a),r=a.content.cloneNode(!0);else{var i=m.createElement("div");i.innerHTML=t.template,(r=m.createDocumentFragment()).appendChild(i)}return q=[],N(r,e),r}(l,r),u=d.childNodes,p=u.length;for(b=0;b<p;b++)if(1===(c=u[b]).nodeType){var f=c.id;f||(f=T.getId(),c.id=f),C[f]=l,c.classList.add("wb5React")}var h=d.querySelector("[role=combobox]");l.data.mustExist&&d.querySelector("[role=combobox] input").setAttribute("data-rule-mustExist","true");s.parentNode.insertBefore(d,s);r.hideSourceUI?a.addClass("hidden"):(s.id=T.getId(),E.appendChild(s));for(var b=0;b<q.length;b++)q[b];a=I(d),s.dataset.wbLoad&&I(h).trigger({type:"json-fetch.wb",fetch:{url:s.dataset.wbLoad}}),"function"!=typeof E.getElementById&&(E.getElementById=function(e){var t,a,r=this.childNodes,n=r.length;for(t=0;t<n;t+=1)if((a=r[t]).id===e)return a;return!1}),Modernizr.addTest("stringnormalize","normalize"in String),Modernizr.load({test:Modernizr.stringnormalize,nope:["site!deps/unorm"+T.getMode()+".js"]}),T.ready(a,w)}}),T.add(y)}(jQuery,window,document,wb),function(d,a,u){"use strict";function r(e,t){e.id||(e.id=u.getId());for(var a=0;a<i.items.length;a++){var r=i.items[a],n=d.extend({},r,{value:r.label,textContent:r.label});n.source||(n.source=e.id),t.data.options.push(n)}}var e=u.doc,i={};d.expr[":"].checked;e.on("combobox.createctrl.wb-fieldflow",".wb-fieldflow",function(e,t){i=t,a["wb-combobox"]||(a["wb-combobox"]={}),a["wb-combobox"].parserUI=[],a["wb-combobox"].parserUI[e.target.id]=r,a["wb-combobox"].hideSourceUI=!0,e.target.classList.add("wb-combobox"),d(e.target).trigger("wb-init.wb-combobox"),d(e.target).data().wbFieldflowRegister=[d(e.target).before().get(0).id],d(e.target).attr("data-wb-fieldflow-origin",d(e.target).before().get(0).id)}),e.on("wb.change","[role=combobox]:not(.wb-fieldflow-init)",function(e,t){var a=e.currentTarget,r=(d(a),t.item);a.id||(a.id=u.getId());var n,i=d("#"+r.bind).parentsUntil(".wb-fieldflow").parent();if(i.length){n=i.get(0).id,r.source;var o=d("#"+r.bind).data().wbFieldflow;d.isArray(o)||(o=[o]);for(var s=0;s<o.length;s++){var l=o[s],c=l.action+".action.wb-fieldflow";l.provEvt="#"+n,d("#"+n).trigger(c,l)}}})}(jQuery,window,(document,wb)),function(f,i,h){"use strict";var b,g,m,v,w,y="wb-steps",x="."+y,e=h.doc,k=function(e,t,a,r){var n=i.createElement(e);return n.className=("prev"===t?"btn btn-md btn-default":"btn btn-md btn-primary")+" "+a,n.href="#",n.setAttribute("aria-labelby",r),n.setAttribute("rel",t),n.setAttribute("role","button"),n.innerHTML=r,n},A=function(e){e.addEventListener("click",function(e){e.preventDefault();var t=!!this.className&&this.className,a=t&&-1<t.indexOf("btn-primary"),r=!0;a&&jQuery.validator&&"undefined"!==jQuery.validator&&(r=f("#"+this.parentElement.parentElement.parentElement.id).valid()),r?(n(this.parentElement,a),a&&this.parentElement.previousElementSibling.classList.remove("wb-steps-error")):a&&!r&&this.parentElement.previousElementSibling.classList.add("wb-steps-error")})},n=function(e,t){var a,r;e&&(e.classList.add("hidden"),(r=!!e.previousElementSibling&&e.previousElementSibling)&&r.classList.remove("wb-steps-active"),(a=t?e.parentElement.nextElementSibling:e.parentElement.previousElementSibling)&&(r=a.getElementsByTagName("LEGEND")[0],e=a.getElementsByTagName("DIV")[0],r&&r.classList.add("wb-steps-active"),e&&e.classList.remove("hidden")))};e.on("timerpoke.wb wb-init.wb-steps",x,function(e){var t=h.init(e,y,x);if(t){t.id||(t.id=h.getId()),g||(b=h.i18n,g={prv:b("prv"),nxt:b("nxt")});var a,r=t.getElementsByTagName("FORM")[0],n=r?f(r).children("fieldset"):0;m&&v&&w||(m=k("A","prev","mrgn-rght-sm mrgn-bttm-md",g.prv),v=k("A","next","mrgn-bttm-md",g.nxt),(w=r.querySelector("input[type=submit], button[type=submit]")).classList.add("mrgn-bttm-md"));for(var i=0,o=n.length;i<o;i++){var s,l=n[i],c=0===i,d=i===o-1,u=l.firstElementChild,p=!(!u||"LEGEND"!==u.tagName)&&u.nextElementSibling;if(p&&"DIV"===p.tagName)a=!0,c||(s=m.cloneNode(!0),A(s),p.appendChild(s)),d?p.appendChild(w):(s=v.cloneNode(!0),A(s),p.appendChild(s)),l.classList.add("wb-tggle-fildst"),p.classList.add("hidden"),c&&(u.classList.add("wb-steps-active"),p.classList.remove("hidden"))}r&&a&&f(r).children("input").hide()}}),h.add(x)}(jQuery,(window,document),wb),function(u,n,o){"use strict";var p,f,h,b,g,m,v,w,d,y,i,x="wb-chtwzrd",k="."+x,s=x+"-replace",A=o.doc,j={},C={},E={en:{"chtwzrd-send":"Send<span class='wb-inv'> reply and continue</span>","chtwzrd-toggle":"Switch to wizard","chtwzrd-notification":"Close chat notification","chtwzrd-open":"Open chat wizard","chtwzrd-minimize":"Minimize chat wizard","chtwzrd-history":"Conversation history","chtwzrd-reply":"Reply","chtwzrd-controls":"Controls","chtwzrd-toggle-basic":"Switch to basic form","chtwzrd-waiting":"Waiting for message","chtwzrd-answer":"You have answered:"},fr:{"chtwzrd-send":"Envoyer<span class='wb-inv'> la réponse et continuer</span>","chtwzrd-toggle":"Basculer vers l&apos;assistant","chtwzrd-notification":"Fermer la notification de discussion","chtwzrd-open":"Ouvrir l&apos;assistant de discussion","chtwzrd-minimize":"Réduire l&apos;assistant de discussion","chtwzrd-history":"Historique de discussion","chtwzrd-reply":"Répondre","chtwzrd-controls":"Contrôles","chtwzrd-toggle-basic":"Basculer vers le formulaire","chtwzrd-waiting":"En attente d&apos;un message","chtwzrd-answer":"Vous avez répondu&nbsp;:"}},r=function(t){if(t.data(x+"-src")){var e=t.data(x+"-src");u.getJSON(e,function(e){c(t,j=e),a(t)})}else j=l(t),a(t)},a=function(e){b=localStorage.getItem("wb-chtwzrd-notif"),e.removeClass("hidden wb-inv").addClass(x+"-basic"),p=!(C={shortDelay:500,mediumDelay:750,longDelay:1250,xLongDelay:2e3,xxLongDelay:2500}),m=j.header.first,v=j.header.instructions?j.header.instructions:"",g=j.header.defaultDestination,w=j.questions[m],f=j.header.formType?j.header.formType:"dynamic",h=!!j.header.inline,E={send:(E=E[u("html").attr("lang")||"en"])["chtwzrd-send"],toggle:E["chtwzrd-toggle"],notification:E["chtwzrd-notification"],trigger:E["chtwzrd-open"],minimize:E["chtwzrd-minimize"],conversation:E["chtwzrd-history"],reply:E["chtwzrd-reply"],controls:E["chtwzrd-controls"],toggleBasic:E["chtwzrd-toggle-basic"],waiting:E["chtwzrd-waiting"],answer:E["chtwzrd-answer"]},T(e,j.header.title);var t,a=u(k+"-basic"),r=u(k+"-bubble-wrap"),n=u(k+"-container"),i=u(".body",n),o=u(".history",n),s=u(".minimize",n),l=u(".basic-link",n),c=s,d=l;S(a),I(r),l.on("click",function(e){e.preventDefault();var t=u("legend:first",a);t.attr("tabindex","0"),o.attr("aria-live",""),q(a,"form"),n.stop().hide(),a.stop().show(function(){t.focus(),t.removeAttr("tabindex")}),u("body").removeClass(x+"-noscroll")}),u(k+"-link").on("click",function(e){e.preventDefault(),a.stop().hide(),t=u(":focus"),u(this).hasClass(x+"-bubble")||q(n,"wizard"),u(".bubble",r).removeClass("trans-pulse"),u("p",r).hide().removeClass("trans-left"),n.stop().show(),r.stop().hide(),h||u("body").addClass(x+"-noscroll"),o.length&&u(".conversation",n).scrollTop(o[0].scrollHeight),p||N(i),localStorage.setItem("wb-chtwzrd-notif",1)}),h?u(k+"-link").click():n.on("keydown",function(e){9===e.keyCode&&(e.shiftKey?c.is(":focus")&&(e.preventDefault(),d.focus()):d.is(":focus")&&(e.preventDefault(),c.focus())),27===e.keyCode&&s.click()}),A.on("click",k+"-container .btn-send",function(e){if("submit"!==u(this).attr("type")){e.preventDefault();var t=u("input:checked",i);t.length||(t=u("input:first",i)).attr("checked",!0),z(i,L(t),!1)}}),s.on("click",function(e){e.preventDefault(),n.stop().hide(),r.stop().show(),u("body").removeClass(x+"-noscroll"),t.focus()})},S=function(e){var r=u("form",e),t=u("fieldset",e),a=t.first();"dynamic"===f&&(a.addClass(x+"-first-q"),t.not(k+"-first-q").hide()),e.hide(),u("input",r).prop("checked",!1),r.append("<button class='btn btn-sm btn-link "+x+"-link mrgn-rght-sm'>"+E.toggle+"</button>"),u("input",r).on("change",function(){var e=L(u(this)),t=u("#"+e.qNext,r);if("dynamic"===f){var a=u(this).closest("fieldset");!t.is(":hidden")&&a.next().attr("id")===t.attr("id")&&"none"!==e.qNext||a.nextAll("fieldset").hide().find("input").prop("checked",!1),"none"!==e.qNext&&u("#"+e.qNext).show(),""!==e.url&&r.attr("action",e.url)}})},I=function(t){var a=u("#wb-info"),e=u(k+"-link",t);if(j.header.avatar&&e.css("background-image","url("+j.header.avatar+")"),t.fadeIn("slow"),a.addClass(x+"-mrgn"),a.length){var r=function(e){u(n).scrollTop()>=u(document).outerHeight()-u(n).outerHeight()-a.outerHeight()?e.css({bottom:a.outerHeight()-(u(document).outerHeight()-u(n).outerHeight()-u(n).scrollTop())+30}):e.css({bottom:30})};r(t),u(n).on("resize scroll",function(){r(t)})}u(".notif",t).on("click",function(){e.click()}),u(".notif-close",t).on("click",function(e){e.preventDefault(),u(this).parent().hide(),t.focus(),localStorage.setItem("wb-chtwzrd-notif",1)})},l=function(e){var t=u("form",e),a=u("h2",e).first(),r=u("p:not("+k+"-greetings):not("+k+"-farewell)",t).first(),n="btn-former-send",i={};i.header=(e.data(x),e.data(x)?e.data(x):{}),i.header.inline=e.hasClass("wb-chtwzrd-inline"),i.header.avatar=e.data(x+"-avatar"),i.header.defaultDestination=t.attr("action"),i.header.name=t.attr("name"),i.header.method=t.attr("method"),i.header.form={},i.header.form.title=a.html(),i.header.title=O(a,i.header.form.title),i.header.greetings=u("p"+k+"-greetings",t).html(),i.header.farewell=u("p"+k+"-farewell",t).html(),i.header.form.sendButton=u("input[type=submit]",t).length?u("input[type=submit]",t).addClass(n).val():u("button[type=submit]",t).addClass(n).html(),i.header.sendButton=O(u("."+n,t),i.header.form.sendButton),r.length&&(i.header.form.instructions=r.html(),i.header.instructions=O(r,i.header.form.instructions));var o=u("fieldset",e);return i.questions={},void 0!==i.header.first&&i.header.first||(i.header.first=o.first().attr("id")),o.each(function(){var e=u("legend",u(this)),t=u("label",u(this)),a=u(this).attr("id"),r=u("input[type=radio]",u(this)).length?"radio":"checkbox",o=[],s="";t.each(function(e){var t=u("input",u(this)),a={},r=t.attr("name"),n=t.data(x+"-url"),i=t.siblings("span:not(.no-"+x+")").html();e||(s=r),a.content=i,a.value=t.val(),a.next=t.data(x+"-next"),n&&(a.url=n),o.push(a)}),i.questions[a]={},i.questions[a].name=s,i.questions[a].input=r,i.questions[a].formLabel=e.html(),i.questions[a].label=O(e,i.questions[a].formLabel),i.questions[a].choices=o}),i},T=function(e,t){e.after("<div class='"+x+"-bubble-wrap'><a href='#"+x+"-container aria-controls='"+x+"-container class='"+x+"-link bubble trans-pulse' role='button'>"+E.trigger+"</a>"+(b?"":"<p class='trans-left'><span class='notif'>"+t+"</span> <a href='#' class='notif-close' title='"+E.notification+"' aria-label='"+E.notification+"' role='button'>×</a></p>")+"</div>"),e.next(k+"-bubble-wrap").after("<aside id='"+x+"-container' class='modal-content overlay-def "+x+"-container "+(h?" wb-chtwzrd-contained":"")+"'></aside>");var a=u(k+"-container");a.append("<header class='modal-header header'><h2 class='modal-title title'>"+t+"</h2><button type='button' class='minimize' title='"+E.minimize+"'><span class='glyphicon glyphicon-chevron-down'></span></button></header>"),a.append("<form class='modal-body body' method='GET'></form>");var r=u(".body",a);r.append("<div class='conversation' tabindex='0'><section class='history' aria-live='assertive'><h3 class='wb-inv'>"+E.conversation+"</h3></section><section class='reply'><h3 class='wb-inv'>"+E.reply+"</h3><div class='inputs-zone'></div></section><div class='form-params'></div></div>"),r.append("<section class='controls'><h3 class='wb-inv'>"+E.controls+"</h3><div class='row'><div class='col-xs-12'><button class='btn btn-primary btn-block btn-send' type='button'>"+E.send+"</button></div></div><div class='row'><div class='col-xs-12 text-center mrgn-tp-sm'><a href='#"+x+"-basic' class='btn btn-sm btn-link basic-link' role='button'>"+E.toggleBasic+"</a></div></div></section>"),r.attr("name",j.header.name+"-chat"),r.attr("method",j.header.method),i=u(".btn-send ",r).html()},c=function(e,t){e.html("");var a="<h2>"+t.header.title+"</h2>",r="<p>"+t.header.instructions+"</p>",n=">"+t.header.sendButton+"</button>";t.header.form.title,a="<h2 data-"+s+"='"+t.header.title+"'>"+t.header.form.title+"</h2>",e.append(a+"<form class='mrgn-bttm-xl' action='"+t.header.defaultDestination+"' name='"+t.header.name+"' method='"+(t.header.method?t.header.method:"GET")+"'></form>");var i=u("form",e);t.header.form.instructions,r="<p data-"+s+"='"+t.header.instructions+"'>"+t.header.form.instructions+"</p>",i.append("<p class='wb-chtwzrd-greetings wb-inv'>"+t.header.greetings+"</p>"+r),u.each(t.questions,function(e,a){var r=o.getId(),t="<legend>"+a.label+"</legend>";a.formLabel,a.formLabel&&(t="<legend data-"+s+"='"+a.label+"'>"+a.formLabel+"</legend>"),i.append("<fieldset id='"+e+"' class='"+r+"'>"+t+"<ul class='list-unstyled mrgn-tp-md'></ul></fieldset>");var n=u("."+r,i);u.each(a.choices,function(e,t){r=o.getId(),u("ul",n).append("<li><label><input type='"+a.input+"' value='"+t.value+"' id ='"+r+"' name='"+a.name+"' data-value='"+t.content+"' /> <span>"+t.content+"</span>"),u("#"+r,n).attr("data-"+x+"-next",t.next),t.url,t.url&&u("#"+r,n).attr("data-"+x+"-url",t.url)})}),t.header.form.sendButton,n=" data-"+s+"='"+t.header.sendButton+"'>"+t.header.form.sendButton+"</button>",i.append("<p class='wb-chtwzrd-farewell wb-inv'>"+t.header.farewell+"</p><br/><button type='submit' class='btn btn-sm btn-primary'"+n),void 0!==j.header.first&&j.header.first||(j.header.first=u("fieldset",i).first().attr("id"))},q=function(e,t){if("wizard"===t){var a=u(".conversation",e);n.clearTimeout(d),n.clearTimeout(y),p=!1,g=j.header.defaultDestination,m=j.header.first,v=j.header.instructions?j.header.instructions:"",w=j.questions[m],u(".history, .form-params",a).html(""),u(".btn-send",e).attr("type","button").html(i),u(".history",a).attr("aria-live","assertive"),N(u(".body",e))}else{var r=u("fieldset",e);"dynamic"===f&&(r.not(":first").hide(),u("input",r).prop("checked",!1))}},N=function(n){var i=u(".history",n),o=u(".inputs-zone",n),s=u(".conversation",n),l=u(".btn-send",n),e=""!==m||""!==v||"last"===w?"p":"h4";p=!0,l.prop("disabled",!0),o.html(""),i.append("<div class='row mrgn-bttm-md'><div class='col-xs-9'><"+e+" class='mrgn-tp-0 mrgn-bttm-0'><span class='avatar'></span><span class='question'></span></"+e+"></div></div>");var c=u(".question:last",i);D(c);var t=C.longDelay;h&&""!==m?t=C.xLongDelay:""===m&&""!==v&&(t=C.xxLongDelay),d=setTimeout(function(){""!==m?(c.html(j.header.greetings),m="",N(n)):""!==v?(c.html(v),v="",N(n)):"last"===w?(c.html(j.header.farewell),l.attr("type","submit").prop("disabled",!1).html(j.header.sendButton+"&nbsp;<span class='glyphicon glyphicon-chevron-right small'></span>"),n.attr("action",g)):(c.html(w.label),w.input="radio",y=setTimeout(function(){o.append("<fieldset><legend class='wb-inv'>"+w.label+"</legend><div class='row'><div class='col-xs-12'><ul class='list-unstyled mrgn-tp-sm choices'></ul></div></div></fieldset>");for(var e=0;e<w.choices.length;e++){var t=w.choices[e];u(".choices",o).append("<li><label><input type='"+w.input+"' value='"+t.value+"' name='"+w.name+"' data-"+x+"-next='"+t.next+"'"+(void 0===t.url?"":" data-"+x+"-url='"+t.url+"'")+(e?"":"checked ")+"/> <span>"+t.content+"</span></label></li>")}l.prop("disabled",!1);var a=s[0].scrollHeight,r=u(".reply",n);r.length&&r.outerHeight()+c.outerHeight()>s.innerHeight()&&(a=i[0].scrollHeight-c.outerHeight()-42),s.scrollTop(a)},C.mediumDelay)),s.scrollTop(s[0].scrollHeight)},t)},z=function(e,t){var a=o.getId(),r=u(".history",e);r.append("<div class='row mrgn-bttm-md'><div class='col-xs-9 col-xs-offset-3'><div class='message text-right pull-right' id='"+a+"'><p class='mrgn-bttm-0'><span class='wb-inv'>"+E.answer+" </span>"+t.value+"</p></div></div></div>"),u(".form-params",e).append("<input type='hidden' name='"+t.name+"' value='"+t.val+"' data-value='"+t.value+"' />"),p=!1,""!==t.url&&(g=t.url);var n=t.qNext,i=u("#"+a,r);w="none"===n?"last":j.questions[n],u(".btn-send",e).prop("disabled",!0),i.attr("tabindex","0"),d=setTimeout(function(){u(".inputs-zone",e).remove("fieldset"),i.focus(),i.removeAttr("tabindex"),N(e)},C.shortDelay)},D=function(e){e.html("<span class='loader-typing' aria-label='"+E.waiting+"'><span class='loader-dot dot1'></span><span class='loader-dot dot2'></span><span class='loader-dot dot3'></span></span>")},O=function(e,t){var a=e.data(s);return a||t},L=function(e){var t=e.data(x+"-next"),a=e.data(x+"-url");return{qNext:t,name:e.attr("name"),val:e.val(),url:a||"",value:e.next().html()}};A.on("timerpoke.wb wb-init.wb-chtwzrd",k,function(e){var t,a=o.init(e,x,k);a&&(t=u(a),r(t),o.ready(t,x))}),o.add(k)}(jQuery,window,wb),$(document).on("do.wb-actionmng","table[data-wb-urlmapping][data-wb5-bind]",function(e){var t=$(e.currentTarget);t.one("draw.dt",function(){t.trigger("refreshCtrl.wbtbl")})});